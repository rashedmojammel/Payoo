<!doctype html>
<html data-theme="light">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css"/>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous"/>
  <!-- QR Code library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <title>Payoo | Home</title>
  <link rel="shortcut icon" href="./assets/logo.png" type="image/x-icon">
  <style type="text/tailwindcss">
    * { font-family:"Outfit",sans-serif; }
    .animate-fade-in { animation:fadeIn 0.3s ease-in-out; }
    @keyframes fadeIn { from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:translateY(0)} }

    .confetti-piece {
      position:fixed; top:-10px; border-radius:2px;
      animation:confettiFall linear forwards; pointer-events:none; z-index:9999;
    }
    @keyframes confettiFall {
      0%{transform:translateY(0) rotate(0deg);opacity:1}
      100%{transform:translateY(110vh) rotate(720deg);opacity:0}
    }

    /* Pull-to-refresh */
    #ptr-indicator { position:fixed;top:70px;left:50%;transform:translateX(-50%);z-index:100;transition:opacity 0.3s;display:flex;flex-direction:column;align-items:center;gap:6px; }
    #ptr-spinner { width:28px;height:28px;border-radius:50%;border:3px solid #e5e7eb;border-top-color:#3B25C1;animation:spin 0.7s linear infinite; }
    @keyframes spin { to{transform:rotate(360deg)} }

    /* Bottom nav */
    .nav-item.active i, .nav-item.active p { color:#3B25C1 !important; }
    .nav-item.active::before { content:"";position:absolute;top:0;left:50%;transform:translateX(-50%);width:36px;height:3px;background:#3B25C1;border-radius:0 0 4px 4px; }
    .nav-item { position:relative; }
    main { padding-bottom:90px; }

    /* Onboarding overlay */
    #onboarding { position:fixed;inset:0;z-index:9000;background:rgba(0,0,0,0.85);display:flex;align-items:flex-end; }
    #onboarding.hidden { display:none; }
    .onboard-card { animation:slideUp 0.4s cubic-bezier(.34,1.56,.64,1); }
    @keyframes slideUp { from{transform:translateY(100%);opacity:0} to{transform:translateY(0);opacity:1} }

    /* Scheduled ping dot */
    .ping-dot { animation:ping 1.5s cubic-bezier(0,0,0.2,1) infinite; }
    @keyframes ping { 75%,100%{transform:scale(2);opacity:0} }

    /* Profile avatar ring */
    .avatar-ring { background:linear-gradient(135deg,#3B25C1,#7c3aed,#06b6d4); padding:2px; border-radius:50%; }
  </style>
</head>

<body class="min-h-screen max-w-md bg-base-200 mx-auto">

<!-- â•â•â• ONBOARDING TUTORIAL â•â•â• -->
<div id="onboarding">
  <div class="onboard-card w-full bg-base-100 rounded-t-3xl p-6 pb-10">
    <div class="flex justify-between items-center mb-6">
      <div class="flex gap-1.5" id="onboard-dots"></div>
      <button onclick="skipOnboarding()" class="text-xs text-gray-400 underline">Skip</button>
    </div>
    <div id="onboard-content"></div>
    <div class="flex gap-3 mt-8">
      <button id="onboard-back" onclick="onboardStep(-1)" class="btn rounded-2xl flex-1 hidden">Back</button>
      <button id="onboard-next" onclick="onboardStep(1)" class="btn bg-[#3B25C1] text-white border-none rounded-2xl flex-1">Next â†’</button>
    </div>
  </div>
</div>

<!-- Pull-to-refresh indicator -->
<div id="ptr-indicator" style="opacity:0;pointer-events:none;"><div id="ptr-spinner"></div><p style="font-size:10px;color:#3B25C1;font-weight:600;font-family:Outfit,sans-serif;">Release to refresh</p></div>

<!-- â•â•â• HEADER â•â•â• -->
<header class="border-b border-base-300 sticky top-0 bg-base-200 z-20">
  <section class="w-11/12 mx-auto py-2.5 flex justify-between items-center">
    <button onclick="setNav('profile')" class="flex gap-2.5 items-center">
      <div class="avatar-ring shrink-0">
        <div id="header-avatar" class="w-9 h-9 rounded-full bg-[#3B25C1] flex items-center justify-center text-white font-bold text-sm overflow-hidden">U</div>
      </div>
      <div class="text-left">
        <div class="text-base font-black text-[#3B25C1] leading-none">Pay<span class="text-neutral">oo</span></div>
        <div class="flex items-center gap-1 mt-0.5">
          <p class="text-neutral/40 text-xs">à§³<span id="balance">45,000</span></p>
        </div>
      </div>
    </button>
    <div class="flex items-center gap-0.5">
      <button id="theme-toggle" onclick="toggleTheme()" class="btn btn-ghost btn-sm rounded-xl">
        <i id="theme-icon" class="fa-solid fa-moon text-base"></i>
      </button>
      <button onclick="setNav('notifications')" class="btn btn-ghost btn-sm rounded-xl relative">
        <i class="fa-solid fa-bell text-base"></i>
        <span id="notif-badge" class="hidden absolute -top-0.5 -right-0.5 bg-red-500 text-white text-[9px] rounded-full w-4 h-4 flex items-center justify-center font-bold"></span>
      </button>
      <button onclick="confirmLogout()" class="btn btn-ghost btn-sm rounded-xl">
        <i class="fa-solid fa-arrow-right-from-bracket text-base"></i>
      </button>
    </div>
  </section>
  <div id="limit-bar-wrap" class="hidden w-11/12 mx-auto pb-2">
    <div class="flex justify-between text-xs text-gray-400 mb-1">
      <span>Monthly Spend</span><span id="limit-bar-label"></span>
    </div>
    <div class="w-full bg-base-300 rounded-full h-1.5">
      <div id="limit-bar" class="h-1.5 rounded-full transition-all duration-700 bg-[#3B25C1]" style="width:0%"></div>
    </div>
  </div>
</header>

<main id="main-content">

<!-- â•â• HOME â•â• -->
<section id="sec-home" class="w-11/12 mx-auto pt-4">
  <div class="mb-4">
    <h1 class="text-xl font-bold">Welcome back, <span id="home-username" class="text-[#3B25C1]">User</span> ğŸ‘‹</h1>
    <p class="text-neutral/40 text-xs">Easy and convenient financial services.</p>
  </div>
  <!-- Balance card -->
  <div class="rounded-3xl p-5 mb-4 text-white relative overflow-hidden" style="background:linear-gradient(135deg,#3B25C1 0%,#7c3aed 100%)">
    <div class="absolute right-0 top-0 w-40 h-40 rounded-full opacity-10" style="background:white;transform:translate(30%,-30%)"></div>
    <div class="absolute right-10 bottom-0 w-24 h-24 rounded-full opacity-10" style="background:white;transform:translateY(40%)"></div>
    <p class="text-white/60 text-xs font-medium mb-1">Available Balance</p>
    <h2 class="text-3xl font-black">à§³<span id="balance-card">45,000</span></h2>
    <p class="text-white/50 text-xs mt-2" id="card-account">01890642735</p>
    <button onclick="setNav('qr')" class="absolute top-4 right-4 bg-white/20 hover:bg-white/30 rounded-xl p-2 transition-colors">
      <i class="fa-solid fa-qrcode text-white text-lg"></i>
    </button>
  </div>
  <!-- Action Grid -->
  <div class="grid grid-cols-4 gap-2 mb-3">
    <button onclick="setNav('addMoney')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1">
      <i class="fa-solid fa-plus-circle text-xl text-[#3B25C1]"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Add</p>
    </button>
    <button onclick="setNav('cashout')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1">
      <i class="fa-solid fa-money-bill-wave text-xl text-[#3B25C1]"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Cashout</p>
    </button>
    <button onclick="setNav('send')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1">
      <i class="fa-solid fa-paper-plane text-xl text-[#3B25C1]"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Send</p>
    </button>
    <button onclick="setNav('paybill')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1">
      <i class="fa-solid fa-file-invoice text-xl text-[#3B25C1]"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Bills</p>
    </button>
    <button onclick="setNav('bonus')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1">
      <i class="fa-solid fa-gift text-xl text-yellow-500"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Bonus</p>
    </button>
    <button onclick="setNav('recharge')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1">
      <i class="fa-solid fa-mobile-screen-button text-xl text-green-600"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Recharge</p>
    </button>
    <button onclick="setNav('contacts')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1">
      <i class="fa-solid fa-star text-xl text-yellow-400"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Contacts</p>
    </button>
    <button onclick="setNav('scheduled')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1 relative">
      <i class="fa-solid fa-clock text-xl text-purple-500"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Scheduled</p>
      <span id="sched-ping" class="hidden absolute top-1 right-1 w-2 h-2 bg-purple-500 rounded-full ping-dot"></span>
    </button>
    <button onclick="setNav('converter')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1">
      <i class="fa-solid fa-coins text-xl text-green-500"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Convert</p>
    </button>
    <button onclick="setNav('emi')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1">
      <i class="fa-solid fa-calculator text-xl text-blue-500"></i>
      <p class="text-neutral/70 text-[10px] font-medium">EMI Calc</p>
    </button>
    <button onclick="setNav('spin')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1 relative">
      <i class="fa-solid fa-dharmachakra text-xl text-pink-500"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Lucky Spin</p>
      <span id="spin-ping" class="absolute top-1 right-1 w-2 h-2 bg-pink-500 rounded-full ping-dot"></span>
    </button>
    <button onclick="setNav('notes')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1">
      <i class="fa-solid fa-note-sticky text-xl text-amber-500"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Notes</p>
    </button>
    <button onclick="setNav('transport')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1">
      <i class="fa-solid fa-van-shuttle text-xl text-sky-500"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Travel</p>
    </button>
    <button onclick="setNav('finance')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1">
      <i class="fa-solid fa-chart-pie text-xl text-emerald-600"></i>
      <p class="text-neutral/70 text-[10px] font-medium">Finance</p>
    </button>
    <button onclick="setNav('ai')" class="btn flex-col h-full py-3 btn-primary btn-soft rounded-2xl gap-1 relative">
      <i class="fa-solid fa-robot text-xl text-violet-500"></i>
      <p class="text-neutral/70 text-[10px] font-medium">AI Advisor</p>
      <span class="absolute top-1 right-1 w-2 h-2 bg-violet-500 rounded-full ping-dot"></span>
    </button>
  </div>
  <!-- Recent transactions preview -->
  <div class="card bg-base-100 rounded-2xl mb-3">
    <div class="card-body py-3 px-4">
      <div class="flex justify-between items-center mb-2">
        <p class="font-bold text-sm">Recent Activity</p>
        <button onclick="setNav('history')" class="text-xs text-[#3B25C1] font-semibold">See all</button>
      </div>
      <div id="recent-tx" class="space-y-2"></div>
    </div>
  </div>
</section>

<!-- â”€â”€ Add Money â”€â”€ -->
<section id="sec-addMoney" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">Add Money</h1>
  <div class="card bg-base-100 rounded-2xl"><div class="card-body gap-3">
    <div><label class="label font-semibold text-sm">Select a Bank</label>
    <select id="addmoney-bank" class="select rounded-2xl bg-base-200 w-full h-12">
      <option disabled selected>Select Bank</option>
      <option value="DBBL">DBBL</option><option value="IBBL">IBBL</option><option value="CITY">City Bank</option>
    </select></div>
    <div><label class="label font-semibold text-sm">Account Number</label>
    <input id="addMoney-input" type="text" maxlength="11" class="input rounded-2xl bg-base-200 w-full h-12" placeholder="11-digit Account Number"/></div>
    <div><label class="label font-semibold text-sm">Amount (BDT)</label>
    <input id="addMoney-amount" type="number" min="1" class="input rounded-2xl bg-base-200 w-full h-12" placeholder="Enter amount"/></div>
    <div><label class="label font-semibold text-sm">4-Digit PIN</label>
    <input id="addMoney-pin" type="password" maxlength="4" class="input rounded-2xl bg-base-200 w-full h-12" placeholder="PIN"/></div>
    <button id="addMoney-btn" class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-12 text-base font-semibold">
      <i class="fa-solid fa-plus mr-2"></i>Add Money</button>
  </div></div>
</section>

<!-- â”€â”€ Cash Out â”€â”€ -->
<section id="sec-cashout" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">Cash Out</h1>
  <div class="card bg-base-100 rounded-2xl"><div class="card-body gap-3">
    <div><label class="label font-semibold text-sm">Agent Number</label>
    <input id="cashout-input" type="text" maxlength="11" class="input rounded-2xl bg-base-200 w-full h-12" placeholder="11-digit agent number"/></div>
    <div><label class="label font-semibold text-sm">Amount (BDT)</label>
    <input id="cashout-amount" type="number" min="1" class="input rounded-2xl bg-base-200 w-full h-12" placeholder="Enter amount"/></div>
    <div><label class="label font-semibold text-sm">4-Digit PIN</label>
    <input id="cashout-pin" type="password" maxlength="4" class="input rounded-2xl bg-base-200 w-full h-12" placeholder="PIN"/></div>
    <button id="cashout-btn" class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-12 text-base font-semibold">
      <i class="fa-solid fa-money-bill-wave mr-2"></i>Withdraw</button>
  </div></div>
</section>

<!-- â”€â”€ Send Money â”€â”€ -->
<section id="sec-send" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">Send Money</h1>
  <div id="send-contacts-row" class="mb-4 hidden">
    <p class="text-sm font-semibold text-neutral/60 mb-2">Quick Pick</p>
    <div id="send-contacts-list" class="flex gap-3 overflow-x-auto pb-1"></div>
  </div>
  <div class="card bg-base-100 rounded-2xl"><div class="card-body gap-3">
    <div><label class="label font-semibold text-sm">Recipient Number</label>
    <input id="Transfer-input" type="text" maxlength="11" class="input rounded-2xl bg-base-200 w-full h-12" placeholder="11-digit number"/></div>
    <div><label class="label font-semibold text-sm">Amount (BDT)</label>
    <input id="Transfer-amount" type="number" min="1" class="input rounded-2xl bg-base-200 w-full h-12" placeholder="Enter amount"/></div>
    <div><label class="label font-semibold text-sm">4-Digit PIN</label>
    <input id="Transfer-pin" type="password" maxlength="4" class="input rounded-2xl bg-base-200 w-full h-12" placeholder="PIN"/></div>
    <button id="Transfer-btn" class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-12 text-base font-semibold">
      <i class="fa-solid fa-paper-plane mr-2"></i>Send Money</button>
  </div></div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     UTILITY BILLS HUB
     Shows a category grid first. Tapping any
     category slides in a payment form for that
     specific service. Back button returns to grid.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="sec-paybill" class="hidden w-11/12 mx-auto py-5">

  <!-- â”€â”€ Page title â”€â”€ -->
  <div class="flex items-center gap-3 mb-4">
    <!-- Back button â€” only visible when a category form is open -->
    <button id="util-back-btn" onclick="showUtilityGrid()"
      class="hidden btn btn-ghost btn-sm rounded-xl px-2">
      <i class="fa-solid fa-arrow-left text-lg"></i>
    </button>
    <div>
      <h1 class="font-bold text-2xl leading-none" id="util-page-title">Pay Bills</h1>
      <p class="text-neutral/40 text-xs mt-0.5" id="util-page-sub">Choose a utility to pay</p>
    </div>
  </div>

  <!-- â•â• CATEGORY GRID (shown by default) â•â• -->
  <div id="util-grid">

    <!-- Row 1 â€” Utilities -->
    <p class="text-xs font-bold text-neutral/40 uppercase tracking-widest mb-2">Utilities</p>
    <div class="grid grid-cols-3 gap-3 mb-4">

      <button onclick="openUtility('wasa')"
        class="util-cat-btn flex flex-col items-center gap-2 bg-base-100 rounded-2xl py-4 shadow-sm hover:shadow-md transition-all">
        <div class="w-11 h-11 rounded-xl flex items-center justify-center" style="background:#e0f2fe">
          <i class="fa-solid fa-droplet text-xl" style="color:#0284c7"></i>
        </div>
        <p class="text-xs font-semibold text-center leading-tight">WASA<br>Water</p>
      </button>

      <button onclick="openUtility('electricity')"
        class="util-cat-btn flex flex-col items-center gap-2 bg-base-100 rounded-2xl py-4 shadow-sm hover:shadow-md transition-all">
        <div class="w-11 h-11 rounded-xl flex items-center justify-center" style="background:#fef9c3">
          <i class="fa-solid fa-bolt text-xl" style="color:#ca8a04"></i>
        </div>
        <p class="text-xs font-semibold text-center leading-tight">DESCO/<br>DPDC</p>
      </button>

      <button onclick="openUtility('gas')"
        class="util-cat-btn flex flex-col items-center gap-2 bg-base-100 rounded-2xl py-4 shadow-sm hover:shadow-md transition-all">
        <div class="w-11 h-11 rounded-xl flex items-center justify-center" style="background:#fce7f3">
          <i class="fa-solid fa-fire-flame-curved text-xl" style="color:#db2777"></i>
        </div>
        <p class="text-xs font-semibold text-center leading-tight">Titas<br>Gas</p>
      </button>

      <button onclick="openUtility('landline')"
        class="util-cat-btn flex flex-col items-center gap-2 bg-base-100 rounded-2xl py-4 shadow-sm hover:shadow-md transition-all">
        <div class="w-11 h-11 rounded-xl flex items-center justify-center" style="background:#f3e8ff">
          <i class="fa-solid fa-phone text-xl" style="color:#7c3aed"></i>
        </div>
        <p class="text-xs font-semibold text-center leading-tight">BTCL<br>Landline</p>
      </button>

      <button onclick="openUtility('internet')"
        class="util-cat-btn flex flex-col items-center gap-2 bg-base-100 rounded-2xl py-4 shadow-sm hover:shadow-md transition-all">
        <div class="w-11 h-11 rounded-xl flex items-center justify-center" style="background:#dcfce7">
          <i class="fa-solid fa-wifi text-xl" style="color:#16a34a"></i>
        </div>
        <p class="text-xs font-semibold text-center leading-tight">Internet<br>Bill</p>
      </button>

      <button onclick="openUtility('cable')"
        class="util-cat-btn flex flex-col items-center gap-2 bg-base-100 rounded-2xl py-4 shadow-sm hover:shadow-md transition-all">
        <div class="w-11 h-11 rounded-xl flex items-center justify-center" style="background:#ffedd5">
          <i class="fa-solid fa-tv text-xl" style="color:#ea580c"></i>
        </div>
        <p class="text-xs font-semibold text-center leading-tight">Cable<br>TV</p>
      </button>

    </div>

    <!-- Row 2 â€” Government & Tax -->
    <p class="text-xs font-bold text-neutral/40 uppercase tracking-widest mb-2">Government & Tax</p>
    <div class="grid grid-cols-3 gap-3 mb-4">

      <button onclick="openUtility('municipal')"
        class="util-cat-btn flex flex-col items-center gap-2 bg-base-100 rounded-2xl py-4 shadow-sm hover:shadow-md transition-all">
        <div class="w-11 h-11 rounded-xl flex items-center justify-center" style="background:#e0f2fe">
          <i class="fa-solid fa-landmark text-xl" style="color:#0369a1"></i>
        </div>
        <p class="text-xs font-semibold text-center leading-tight">Municipal<br>Tax</p>
      </button>

      <button onclick="openUtility('passport')"
        class="util-cat-btn flex flex-col items-center gap-2 bg-base-100 rounded-2xl py-4 shadow-sm hover:shadow-md transition-all">
        <div class="w-11 h-11 rounded-xl flex items-center justify-center" style="background:#fef3c7">
          <i class="fa-solid fa-passport text-xl" style="color:#b45309"></i>
        </div>
        <p class="text-xs font-semibold text-center leading-tight">Passport<br>Fee</p>
      </button>

    </div>

    <!-- Row 3 â€” Education & Health -->
    <p class="text-xs font-bold text-neutral/40 uppercase tracking-widest mb-2">Education & Health</p>
    <div class="grid grid-cols-3 gap-3">

      <button onclick="openUtility('hospital')"
        class="util-cat-btn flex flex-col items-center gap-2 bg-base-100 rounded-2xl py-4 shadow-sm hover:shadow-md transition-all">
        <div class="w-11 h-11 rounded-xl flex items-center justify-center" style="background:#fee2e2">
          <i class="fa-solid fa-hospital text-xl" style="color:#dc2626"></i>
        </div>
        <p class="text-xs font-semibold text-center leading-tight">Hospital<br>Bill</p>
      </button>

      <button onclick="openUtility('school')"
        class="util-cat-btn flex flex-col items-center gap-2 bg-base-100 rounded-2xl py-4 shadow-sm hover:shadow-md transition-all">
        <div class="w-11 h-11 rounded-xl flex items-center justify-center" style="background:#dbeafe">
          <i class="fa-solid fa-graduation-cap text-xl" style="color:#1d4ed8"></i>
        </div>
        <p class="text-xs font-semibold text-center leading-tight">School/<br>Uni Fee</p>
      </button>

    </div>

    <!-- Recent utility payments -->
    <div class="card bg-base-100 rounded-2xl mt-4">
      <div class="card-body py-3 px-4">
        <p class="font-bold text-sm mb-2">Recent Payments</p>
        <div id="util-recent" class="space-y-2">
          <p class="text-xs text-gray-400 py-1">No recent utility payments</p>
        </div>
      </div>
    </div>

  </div><!-- end #util-grid -->


  <!-- â•â• PAYMENT FORM (hidden until a category is picked) â•â• -->
  <div id="util-form" class="hidden">
    <div class="card bg-base-100 rounded-2xl">
      <div class="card-body gap-4">

        <!-- Dynamic sub-fields injected by JS (provider select, account/meter number etc.) -->
        <div id="util-dynamic-fields"></div>

        <!-- Amount -->
        <div>
          <label class="label font-semibold text-sm">Amount (BDT)</label>
          <input id="util-amount" type="number" min="1"
            class="input rounded-2xl bg-base-200 w-full h-12" placeholder="Enter amount"/>
        </div>

        <!-- PIN -->
        <div>
          <label class="label font-semibold text-sm">4-Digit PIN</label>
          <input id="util-pin" type="password" maxlength="4"
            class="input rounded-2xl bg-base-200 w-full h-12" placeholder="PIN"/>
        </div>

        <!-- Pay button â€” label set by JS -->
        <button id="util-pay-btn" onclick="processUtilityPayment()"
          class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-12 text-base font-semibold">
          <i class="fa-solid fa-circle-check mr-2"></i>Pay Now
        </button>

      </div>
    </div>
  </div><!-- end #util-form -->

</section>

<!-- â”€â”€ Get Bonus â”€â”€ -->
<section id="sec-bonus" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">Get Bonus</h1>
  <div class="card bg-base-100 rounded-2xl"><div class="card-body gap-3">
    <div><label class="label font-semibold text-sm">Coupon Code</label>
    <input id="Bonus-input" type="text" class="input rounded-2xl bg-base-200 w-full h-12" placeholder="Enter coupon code"/>
    <p class="text-xs text-gray-400 mt-1">Try: <span class="font-mono bg-base-200 px-1 rounded">rashed</span>, <span class="font-mono bg-base-200 px-1 rounded">Fatema</span>, <span class="font-mono bg-base-200 px-1 rounded">Mercy</span></p></div>
    <button id="Bonus-btn" class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-12 text-base font-semibold">
      <i class="fa-solid fa-gift mr-2"></i>Redeem</button>
  </div></div>
</section>

<!-- â”€â”€ Mobile Recharge â”€â”€ -->
<section id="sec-recharge" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-1">Mobile Recharge</h1>
  <p class="text-neutral/40 text-xs mb-4">Top-up any number instantly</p>

  <!-- Operator Tabs -->
  <div class="flex gap-2 mb-4 overflow-x-auto pb-1">
    <button onclick="setOperator('grameenphone')" id="op-grameenphone"
      class="op-tab btn btn-sm rounded-xl bg-[#3B25C1] text-white border-none shrink-0">GP</button>
    <button onclick="setOperator('robi')" id="op-robi"
      class="op-tab btn btn-sm rounded-xl bg-base-200 border-none shrink-0">Robi</button>
    <button onclick="setOperator('banglalink')" id="op-banglalink"
      class="op-tab btn btn-sm rounded-xl bg-base-200 border-none shrink-0">Banglalink</button>
    <button onclick="setOperator('teletalk')" id="op-teletalk"
      class="op-tab btn btn-sm rounded-xl bg-base-200 border-none shrink-0">Teletalk</button>
    <button onclick="setOperator('airtel')" id="op-airtel"
      class="op-tab btn btn-sm rounded-xl bg-base-200 border-none shrink-0">Airtel</button>
  </div>

  <!-- Number Input -->
  <div class="card bg-base-100 rounded-2xl mb-3"><div class="card-body gap-3 py-4">
    <div>
      <label class="label font-semibold text-sm">Mobile Number</label>
      <input id="recharge-number" type="text" maxlength="11"
        class="input rounded-2xl bg-base-200 w-full h-12" placeholder="11-digit number"/>
    </div>

    <!-- Package Type Toggle -->
    <div>
      <label class="label font-semibold text-sm">Package Type</label>
      <div class="flex gap-2">
        <button onclick="setRechargeType('prepaid')" id="rtype-prepaid"
          class="rtype-tab btn btn-sm flex-1 rounded-xl bg-[#3B25C1] text-white border-none">Prepaid</button>
        <button onclick="setRechargeType('postpaid')" id="rtype-postpaid"
          class="rtype-tab btn btn-sm flex-1 rounded-xl bg-base-200 border-none">Postpaid</button>
      </div>
    </div>
  </div></div>

  <!-- Quick Packages Grid -->
  <div id="recharge-packages" class="mb-3"></div>

  <!-- Custom amount + PIN -->
  <div class="card bg-base-100 rounded-2xl mb-3"><div class="card-body gap-3 py-4">
    <div>
      <label class="label font-semibold text-sm">Amount (BDT)
        <span class="text-xs text-gray-400 font-normal ml-1">â€” or pick a package above</span>
      </label>
      <input id="recharge-amount" type="number" min="10"
        class="input rounded-2xl bg-base-200 w-full h-12" placeholder="Min à§³10"/>
    </div>
    <div>
      <label class="label font-semibold text-sm">4-Digit PIN</label>
      <input id="recharge-pin" type="password" maxlength="4"
        class="input rounded-2xl bg-base-200 w-full h-12" placeholder="PIN"/>
    </div>
    <button id="recharge-btn"
      class="btn bg-green-600 hover:bg-green-700 text-white border-none rounded-2xl h-12 text-base font-semibold">
      <i class="fa-solid fa-mobile-screen-button mr-2"></i>Recharge Now
    </button>
  </div></div>

  <!-- Recent Recharges -->
  <div class="card bg-base-100 rounded-2xl"><div class="card-body py-3 px-4">
    <p class="font-bold text-sm mb-2">Recent Recharges</p>
    <div id="recent-recharges" class="space-y-2">
      <p class="text-xs text-gray-400 py-2">No recent recharges</p>
    </div>
  </div></div>
</section>

<!-- â”€â”€ QR Code â”€â”€ -->
<section id="sec-qr" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">My QR Code</h1>
  <div class="card bg-base-100 rounded-3xl"><div class="card-body items-center gap-4">
    <p class="text-neutral/50 text-sm text-center">Share this QR code so others can send you money instantly</p>
    <div class="p-4 bg-white rounded-2xl shadow-inner border border-base-200">
      <div id="qr-canvas"></div>
    </div>
    <div class="text-center">
      <p class="font-bold text-lg" id="qr-name">User</p>
      <p class="font-mono text-gray-400 text-sm" id="qr-number">01890642735</p>
    </div>
    <button onclick="downloadQR()" class="btn bg-[#3B25C1] text-white border-none rounded-2xl w-full h-11 font-semibold">
      <i class="fa-solid fa-download mr-2"></i>Save QR Code</button>
  </div></div>
</section>

<!-- â”€â”€ Scheduled Payments â”€â”€ -->
<section id="sec-scheduled" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">Scheduled Payments</h1>
  <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-3">
    <p class="font-semibold text-sm">Add New Schedule</p>
    <div><label class="label text-xs font-semibold">Label</label>
    <input id="sched-label" type="text" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="e.g. Rent, Netflix"/></div>
    <div><label class="label text-xs font-semibold">Recipient Number</label>
    <input id="sched-number" type="text" maxlength="11" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="11-digit number"/></div>
    <div><label class="label text-xs font-semibold">Amount (BDT)</label>
    <input id="sched-amount" type="number" min="1" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="Amount"/></div>
    <div><label class="label text-xs font-semibold">Run On (Day of month)</label>
    <input id="sched-day" type="number" min="1" max="28" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="1-28"/></div>
    <div><label class="label text-xs font-semibold">Frequency</label>
    <select id="sched-freq" class="select rounded-2xl bg-base-200 w-full h-11">
      <option value="monthly">Monthly</option>
      <option value="weekly">Weekly</option>
    </select></div>
    <button onclick="addSchedule()" class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-11 font-semibold">
      <i class="fa-solid fa-clock mr-2"></i>Schedule Payment</button>
  </div></div>
  <div id="schedule-list" class="space-y-3"></div>
</section>

<!-- â”€â”€ Currency Converter â”€â”€ -->
<section id="sec-converter" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">Currency Converter</h1>
  <div class="card bg-base-100 rounded-2xl"><div class="card-body gap-4">
    <div class="grid grid-cols-2 gap-3">
      <div><label class="label text-xs font-semibold">Amount</label>
      <input id="conv-amount" type="number" min="0" class="input rounded-2xl bg-base-200 w-full h-12" placeholder="Enter amount" oninput="convertCurrency()"/></div>
      <div><label class="label text-xs font-semibold">From</label>
      <select id="conv-from" class="select rounded-2xl bg-base-200 w-full h-12" onchange="convertCurrency()">
        <option value="BDT">ğŸ‡§ğŸ‡© BDT</option><option value="USD">ğŸ‡ºğŸ‡¸ USD</option>
        <option value="EUR">ğŸ‡ªğŸ‡º EUR</option><option value="GBP">ğŸ‡¬ğŸ‡§ GBP</option>
        <option value="INR">ğŸ‡®ğŸ‡³ INR</option><option value="SAR">ğŸ‡¸ğŸ‡¦ SAR</option>
        <option value="AED">ğŸ‡¦ğŸ‡ª AED</option><option value="MYR">ğŸ‡²ğŸ‡¾ MYR</option>
      </select></div>
    </div>
    <div class="flex justify-center">
      <button onclick="swapCurrencies()" class="btn btn-circle btn-sm bg-[#3B25C1] text-white border-none">
        <i class="fa-solid fa-arrow-right-arrow-left"></i></button>
    </div>
    <div><label class="label text-xs font-semibold">To</label>
    <select id="conv-to" class="select rounded-2xl bg-base-200 w-full h-12" onchange="convertCurrency()">
      <option value="USD">ğŸ‡ºğŸ‡¸ USD</option><option value="BDT">ğŸ‡§ğŸ‡© BDT</option>
      <option value="EUR">ğŸ‡ªğŸ‡º EUR</option><option value="GBP">ğŸ‡¬ğŸ‡§ GBP</option>
      <option value="INR">ğŸ‡®ğŸ‡³ INR</option><option value="SAR">ğŸ‡¸ğŸ‡¦ SAR</option>
      <option value="AED">ğŸ‡¦ğŸ‡ª AED</option><option value="MYR">ğŸ‡²ğŸ‡¾ MYR</option>
    </select></div>
    <div id="conv-result" class="bg-base-200 rounded-2xl p-4 text-center">
      <p class="text-2xl font-black text-[#3B25C1]" id="conv-output">â€”</p>
      <p class="text-xs text-gray-400 mt-1" id="conv-rate"></p>
    </div>
    <p class="text-xs text-gray-400 text-center">* Rates are approximate and for reference only</p>
  </div></div>
</section>

<!-- â”€â”€ Profile â”€â”€ -->
<section id="sec-profile" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">My Profile</h1>
  <div class="card bg-base-100 rounded-3xl mb-4"><div class="card-body items-center gap-3 py-6">
    <div class="avatar-ring cursor-pointer" onclick="document.getElementById('avatar-upload').click()">
      <div id="profile-avatar" class="w-20 h-20 rounded-full bg-[#3B25C1] flex items-center justify-center text-white font-bold text-3xl overflow-hidden">U</div>
    </div>
    <input type="file" id="avatar-upload" accept="image/*" class="hidden" onchange="uploadAvatar(event)"/>
    <p class="text-xs text-gray-400">Tap avatar to change photo</p>
    <div class="w-full space-y-3 mt-2">
      <div><label class="label text-xs font-semibold">Display Name</label>
      <input id="profile-name" type="text" maxlength="30" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="Your name"/></div>
      <div><label class="label text-xs font-semibold">Mobile Number</label>
      <input id="profile-number" type="text" class="input rounded-2xl bg-base-200 w-full h-11" value="01890642735" readonly/></div>
      <button onclick="saveProfile()" class="btn bg-[#3B25C1] text-white border-none rounded-2xl w-full h-11 font-semibold">
        <i class="fa-solid fa-floppy-disk mr-2"></i>Save Profile</button>
    </div>
  </div></div>
  <!-- PIN Change -->
  <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-3">
    <p class="font-bold">Change PIN</p>
    <input id="pin-current" type="password" maxlength="4" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="Current PIN"/>
    <input id="pin-new" type="password" maxlength="4" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="New PIN (4 digits)"/>
    <input id="pin-confirm" type="password" maxlength="4" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="Confirm New PIN"/>
    <button onclick="changePin()" class="btn bg-purple-600 text-white border-none rounded-2xl h-11 font-semibold">
      <i class="fa-solid fa-key mr-2"></i>Change PIN</button>
  </div></div>
</section>

<!-- â”€â”€ Saved Contacts â”€â”€ -->
<section id="sec-contacts" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">Saved Contacts</h1>
  <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-3">
    <p class="font-semibold text-sm">Add New Contact</p>
    <input id="contact-name" type="text" maxlength="30" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="Contact name"/>
    <input id="contact-number" type="text" maxlength="11" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="11-digit number"/>
    <button onclick="addContact()" class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-11 font-semibold">
      <i class="fa-solid fa-user-plus mr-2"></i>Save Contact</button>
  </div></div>
  <div id="contacts-list" class="space-y-3"></div>
</section>

<!-- â”€â”€ Notifications â”€â”€ -->
<section id="sec-notifications" class="hidden w-11/12 mx-auto py-5">
  <div class="flex justify-between items-center mb-4">
    <h1 class="font-bold text-2xl">Notifications</h1>
    <button onclick="clearNotifications()" class="btn btn-sm btn-ghost text-red-400 rounded-xl">
      <i class="fa-solid fa-trash-can"></i></button>
  </div>
  <div id="notif-list" class="space-y-3"></div>
</section>

<!-- â”€â”€ Transactions â”€â”€ -->
<section id="sec-history" class="hidden w-11/12 mx-auto py-5">
  <div class="flex justify-between items-center mb-3">
    <h1 class="font-bold text-2xl">Transactions</h1>
    <div class="flex gap-1">
      <button onclick="exportCSV()" class="btn btn-sm btn-ghost text-green-600 rounded-xl"><i class="fa-solid fa-file-csv"></i></button>
      <button onclick="clearTransactionHistory()" class="btn btn-sm btn-ghost text-red-400 rounded-xl"><i class="fa-solid fa-trash-can"></i></button>
    </div>
  </div>
  <!-- Search bar -->
  <div class="relative mb-3">
    <i class="fa-solid fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 text-sm"></i>
    <input id="tx-search" type="text" class="input rounded-2xl bg-base-100 w-full h-11 pl-10 border border-base-300" placeholder="Search transactionsâ€¦" oninput="renderTransactionHistory()"/>
  </div>
  <!-- Date filter -->
  <div class="grid grid-cols-2 gap-2 mb-3">
    <div><label class="text-xs text-gray-400 mb-1 block">From</label>
    <input id="tx-date-from" type="date" class="input rounded-2xl bg-base-100 w-full h-10 text-sm border border-base-300" onchange="renderTransactionHistory()"/></div>
    <div><label class="text-xs text-gray-400 mb-1 block">To</label>
    <input id="tx-date-to" type="date" class="input rounded-2xl bg-base-100 w-full h-10 text-sm border border-base-300" onchange="renderTransactionHistory()"/></div>
  </div>
  <!-- Filter Tabs -->
  <div class="flex gap-2 mb-4">
    <button id="filter-all"    onclick="setFilter('all')"    class="btn btn-sm rounded-xl bg-[#3B25C1] text-white flex-1 border-none">All</button>
    <button id="filter-credit" onclick="setFilter('credit')" class="btn btn-sm rounded-xl bg-base-300 text-gray-500 flex-1 border-none">Credit</button>
    <button id="filter-debit"  onclick="setFilter('debit')"  class="btn btn-sm rounded-xl bg-base-300 text-gray-500 flex-1 border-none">Debit</button>
  </div>
  <div id="Transaction-history" class="space-y-3 pb-4"></div>
</section>

<!-- â”€â”€ Dashboard â”€â”€ -->

<!-- â”€â”€ Bill Split Calculator â”€â”€ -->
<section id="sec-split" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">Bill Splitter</h1>
  <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-3">
    <div><label class="label text-xs font-semibold">Total Bill (BDT)</label>
    <input id="split-total" type="number" min="1" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="e.g. 3500" oninput="calcSplit()"/></div>
    <div><label class="label text-xs font-semibold">Number of People</label>
    <div class="flex items-center gap-3">
      <button onclick="changePeople(-1)" class="btn btn-sm btn-circle bg-base-200 border-none text-lg font-bold">âˆ’</button>
      <span id="split-people-display" class="text-2xl font-black text-[#3B25C1] w-8 text-center">2</span>
      <button onclick="changePeople(1)" class="btn btn-sm btn-circle bg-[#3B25C1] text-white border-none text-lg font-bold">+</button>
    </div></div>
    <div><label class="label text-xs font-semibold">Tip %</label>
    <div class="flex gap-2">
      <button onclick="setTip(0)" class="tip-btn btn btn-sm rounded-xl bg-base-200 border-none flex-1">No Tip</button>
      <button onclick="setTip(10)" class="tip-btn btn btn-sm rounded-xl bg-base-200 border-none flex-1">10%</button>
      <button onclick="setTip(15)" class="tip-btn btn btn-sm rounded-xl bg-base-200 border-none flex-1">15%</button>
      <button onclick="setTip(20)" class="tip-btn btn btn-sm rounded-xl bg-base-200 border-none flex-1">20%</button>
    </div></div>
  </div></div>
  <div id="split-result" class="card bg-gradient-to-br from-[#3B25C1] to-purple-600 rounded-2xl p-5 text-white hidden">
    <p class="text-white/70 text-xs font-semibold uppercase mb-1">Each Person Pays</p>
    <p id="split-per-person" class="text-4xl font-black">à§³0</p>
    <div class="flex justify-between mt-4 text-sm text-white/70">
      <div><p class="text-white/50 text-xs">Total with tip</p><p id="split-total-tip" class="font-bold text-white">à§³0</p></div>
      <div class="text-right"><p class="text-white/50 text-xs">Tip per person</p><p id="split-tip-per" class="font-bold text-white">à§³0</p></div>
    </div>
  </div>
  <!-- Named split -->
  <div class="card bg-base-100 rounded-2xl mt-4"><div class="card-body gap-3">
    <p class="font-bold text-sm">Add People</p>
    <div class="flex gap-2">
      <input id="split-name-input" type="text" class="input rounded-2xl bg-base-200 flex-1 h-10" placeholder="Name"/>
      <button onclick="addSplitPerson()" class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-10 px-4">Add</button>
    </div>
    <div id="split-people-list" class="space-y-2"></div>
  </div></div>
</section>

<!-- â”€â”€ Savings Goals â”€â”€ -->
<section id="sec-savings" class="hidden w-11/12 mx-auto py-5">
  <div class="flex justify-between items-center mb-4">
    <h1 class="font-bold text-2xl">Savings Goals</h1>
    <button onclick="document.getElementById('add-goal-modal').showModal()" class="btn btn-sm bg-[#3B25C1] text-white border-none rounded-xl">
      <i class="fa-solid fa-plus"></i> New
    </button>
  </div>
  <div id="goals-list" class="space-y-4"></div>
</section>

<!-- Add Goal Modal -->
<dialog id="add-goal-modal" class="modal">
  <div class="modal-box rounded-3xl">
    <h3 class="font-bold text-lg mb-4">New Savings Goal</h3>
    <div class="space-y-3">
      <div><label class="label text-xs font-semibold">Goal Name</label>
      <input id="goal-name" type="text" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="e.g. New Phone, Vacation"/></div>
      <div><label class="label text-xs font-semibold">Target Amount (BDT)</label>
      <input id="goal-target" type="number" min="1" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="e.g. 25000"/></div>
      <div><label class="label text-xs font-semibold">Emoji Icon</label>
      <div class="flex gap-2 flex-wrap">
        <span class="goal-emoji cursor-pointer text-2xl p-1 rounded-xl hover:bg-base-200 selected-emoji" onclick="selectEmoji(this)">ğŸ¯</span>
        <span class="goal-emoji cursor-pointer text-2xl p-1 rounded-xl hover:bg-base-200" onclick="selectEmoji(this)">ğŸ“±</span>
        <span class="goal-emoji cursor-pointer text-2xl p-1 rounded-xl hover:bg-base-200" onclick="selectEmoji(this)">âœˆï¸</span>
        <span class="goal-emoji cursor-pointer text-2xl p-1 rounded-xl hover:bg-base-200" onclick="selectEmoji(this)">ğŸ </span>
        <span class="goal-emoji cursor-pointer text-2xl p-1 rounded-xl hover:bg-base-200" onclick="selectEmoji(this)">ğŸš—</span>
        <span class="goal-emoji cursor-pointer text-2xl p-1 rounded-xl hover:bg-base-200" onclick="selectEmoji(this)">ğŸ’</span>
        <span class="goal-emoji cursor-pointer text-2xl p-1 rounded-xl hover:bg-base-200" onclick="selectEmoji(this)">ğŸ“š</span>
        <span class="goal-emoji cursor-pointer text-2xl p-1 rounded-xl hover:bg-base-200" onclick="selectEmoji(this)">ğŸ’»</span>
      </div></div>
    </div>
    <div class="modal-action gap-3 mt-5">
      <button onclick="document.getElementById('add-goal-modal').close()" class="btn rounded-2xl flex-1">Cancel</button>
      <button onclick="addSavingsGoal()" class="btn bg-[#3B25C1] text-white border-none rounded-2xl flex-1">Create Goal</button>
    </div>
  </div>
</dialog>

<!-- Deposit to Goal Modal -->
<dialog id="deposit-goal-modal" class="modal">
  <div class="modal-box rounded-3xl">
    <h3 class="font-bold text-lg mb-1">Add to Goal</h3>
    <p id="deposit-goal-name" class="text-neutral/50 text-sm mb-4"></p>
    <input id="deposit-goal-amount" type="number" min="1" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="Amount to add (BDT)"/>
    <div class="modal-action gap-3 mt-4">
      <button onclick="document.getElementById('deposit-goal-modal').close()" class="btn rounded-2xl flex-1">Cancel</button>
      <button onclick="depositToGoal()" class="btn bg-[#3B25C1] text-white border-none rounded-2xl flex-1">Deposit</button>
    </div>
  </div>
</dialog>

<!-- â”€â”€ Budget Planner â”€â”€ -->
<section id="sec-budget" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">Budget Planner</h1>
  <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-3">
    <p class="font-semibold text-sm">Set Category Budget</p>
    <div class="grid grid-cols-2 gap-2">
      <div><label class="label text-xs font-semibold">Category</label>
      <select id="budget-cat" class="select rounded-2xl bg-base-200 w-full h-11">
        <option value="Food">ğŸ” Food</option>
        <option value="Transport">ğŸšŒ Transport</option>
        <option value="Bills">ğŸ’¡ Bills</option>
        <option value="Shopping">ğŸ›ï¸ Shopping</option>
        <option value="Health">ğŸ’Š Health</option>
        <option value="Entertainment">ğŸ¬ Entertainment</option>
        <option value="Other">ğŸ“¦ Other</option>
      </select></div>
      <div><label class="label text-xs font-semibold">Monthly Limit (BDT)</label>
      <input id="budget-amount" type="number" min="1" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="Amount"/></div>
    </div>
    <button onclick="addBudget()" class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-11 font-semibold">
      <i class="fa-solid fa-plus mr-2"></i>Set Budget</button>
  </div></div>
  <div id="budget-list" class="space-y-3"></div>
</section>

<!-- â”€â”€ Loan Tracker â”€â”€ -->
<section id="sec-loans" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">Loan Tracker</h1>
  <!-- Summary -->
  <div class="grid grid-cols-2 gap-3 mb-4">
    <div class="card bg-green-50 rounded-2xl p-4">
      <p class="text-xs text-green-600 font-bold uppercase">You'll Receive</p>
      <p id="loan-receivable" class="text-xl font-black text-green-600 mt-1">à§³0</p>
    </div>
    <div class="card bg-red-50 rounded-2xl p-4">
      <p class="text-xs text-red-500 font-bold uppercase">You Owe</p>
      <p id="loan-payable" class="text-xl font-black text-red-500 mt-1">à§³0</p>
    </div>
  </div>
  <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-3">
    <p class="font-semibold text-sm">Add Record</p>
    <div class="flex gap-2">
      <button id="loan-type-lent" onclick="setLoanType('lent')" class="btn btn-sm flex-1 rounded-xl bg-green-500 text-white border-none">I Lent</button>
      <button id="loan-type-borrowed" onclick="setLoanType('borrowed')" class="btn btn-sm flex-1 rounded-xl bg-base-200 border-none">I Borrowed</button>
    </div>
    <input id="loan-person" type="text" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="Person's name"/>
    <input id="loan-amount" type="number" min="1" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="Amount (BDT)"/>
    <input id="loan-note" type="text" class="input rounded-2xl bg-base-200 w-full h-11" placeholder="Note (optional)"/>
    <button onclick="addLoan()" class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-11 font-semibold">
      <i class="fa-solid fa-handshake mr-2"></i>Add Record</button>
  </div></div>
  <div id="loans-list" class="space-y-3"></div>
</section>

<!-- â”€â”€ Referral System â”€â”€ -->
<section id="sec-referral" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-4">Referral & Rewards</h1>
  <!-- My code -->
  <div class="rounded-3xl p-5 mb-4 text-white relative overflow-hidden" style="background:linear-gradient(135deg,#7c3aed,#3B25C1)">
    <div class="absolute -right-6 -top-6 w-28 h-28 rounded-full bg-white/10"></div>
    <p class="text-white/70 text-xs font-semibold uppercase mb-1">Your Referral Code</p>
    <p id="my-referral-code" class="text-3xl font-black tracking-widest mb-3">PAYOO00</p>
    <button onclick="copyReferralCode()" class="btn btn-sm bg-white/20 hover:bg-white/30 text-white border-none rounded-xl">
      <i class="fa-solid fa-copy mr-1"></i>Copy Code</button>
    <div class="mt-3 flex gap-4 text-sm">
      <div><p class="text-white/50 text-xs">Referrals</p><p id="referral-count" class="font-black text-white text-xl">0</p></div>
      <div><p class="text-white/50 text-xs">Earned</p><p id="referral-earned" class="font-black text-white text-xl">à§³0</p></div>
    </div>
  </div>
  <!-- Redeem -->
  <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-3">
    <p class="font-bold">Redeem a Referral Code</p>
    <p class="text-sm text-neutral/50">Enter a friend's code to earn à§³200 bonus each!</p>
    <div class="flex gap-2">
      <input id="referral-input" type="text" maxlength="10" class="input rounded-2xl bg-base-200 flex-1 h-11" placeholder="Enter code (e.g. PAYOO12345)"/>
      <button onclick="redeemReferral()" class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-11 px-5 font-semibold">Redeem</button>
    </div>
  </div></div>
  <!-- How it works -->
  <div class="card bg-base-100 rounded-2xl"><div class="card-body gap-2">
    <p class="font-bold mb-1">How it works</p>
    <div class="flex gap-3 items-start"><div class="w-6 h-6 rounded-full bg-[#3B25C1] text-white flex items-center justify-center text-xs font-bold shrink-0">1</div><p class="text-sm text-neutral/60">Share your referral code with friends</p></div>
    <div class="flex gap-3 items-start"><div class="w-6 h-6 rounded-full bg-[#3B25C1] text-white flex items-center justify-center text-xs font-bold shrink-0">2</div><p class="text-sm text-neutral/60">They enter your code in Payoo</p></div>
    <div class="flex gap-3 items-start"><div class="w-6 h-6 rounded-full bg-[#3B25C1] text-white flex items-center justify-center text-xs font-bold shrink-0">3</div><p class="text-sm text-neutral/60">You both earn à§³200 bonus instantly!</p></div>
  </div></div>
</section>

<!-- â”€â”€ Achievements â”€â”€ -->
<section id="sec-achievements" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-1">Achievements</h1>
  <p class="text-neutral/40 text-sm mb-5">Unlock badges by using Payoo</p>
  <div id="achievements-grid" class="grid grid-cols-3 gap-3"></div>
</section>

<section id="sec-dashboard" class="hidden"></section>

<!-- â”€â”€ Settings â”€â”€ -->
<section id="sec-settings" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-5">Settings</h1>
  <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-3">
    <p class="font-bold">Monthly Spending Limit</p>
    <p class="text-sm text-neutral/50">Get alerted at 80% and 100% of your limit.</p>
    <div class="flex gap-2">
      <input id="limit-input" type="number" min="0" class="input rounded-2xl bg-base-200 flex-1 h-11" placeholder="e.g. 10000"/>
      <button onclick="saveSpendingLimit()" class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-11 px-5 font-semibold">Save</button>
    </div>
    <div id="current-limit-display" class="text-sm text-neutral/50"></div>
  </div></div>
  <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body flex-row items-center justify-between">
    <div><p class="font-bold">Dark Mode</p><p class="text-sm text-neutral/50">Toggle theme</p></div>
    <input type="checkbox" id="dark-toggle-settings" class="toggle toggle-primary" onchange="toggleTheme()"/>
  </div></div>
  <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-3">
    <p class="font-bold">Export Statement</p>
    <button onclick="exportCSV()" class="btn bg-green-600 text-white border-none rounded-2xl h-11 font-semibold">
      <i class="fa-solid fa-file-csv mr-2"></i>Download CSV</button>
  </div></div>
  <div class="card bg-base-100 rounded-2xl"><div class="card-body gap-2">
    <p class="font-bold">About</p>
    <p class="text-sm text-neutral/50">Payoo v3.0 â€” Your trusted mobile wallet</p>
    <button onclick="setNav('profile')" class="btn btn-ghost rounded-2xl h-10 text-sm">Edit Profile & Change PIN â†’</button>
  </div></div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     EMI CALCULATOR SECTION
     User enters loan amount, interest rate, months
     and sees monthly payment + full breakdown
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="sec-emi" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-1">EMI Calculator</h1>
  <p class="text-neutral/40 text-xs mb-4">Calculate your monthly loan installment</p>

  <!-- Input Card -->
  <div class="card bg-base-100 rounded-2xl mb-4">
    <div class="card-body gap-4">

      <div>
        <label class="label font-semibold text-sm">Loan Amount (BDT)</label>
        <input id="emi-amount" type="number" min="1"
          class="input rounded-2xl bg-base-200 w-full h-12"
          placeholder="e.g. 100000"
          oninput="calculateEMI()" />
      </div>

      <div>
        <label class="label font-semibold text-sm">Annual Interest Rate (%)</label>
        <input id="emi-rate" type="number" min="0" step="0.1"
          class="input rounded-2xl bg-base-200 w-full h-12"
          placeholder="e.g. 9.5"
          oninput="calculateEMI()" />
      </div>

      <div>
        <label class="label font-semibold text-sm">Loan Term (Months)</label>
        <input id="emi-months" type="number" min="1" max="360"
          class="input rounded-2xl bg-base-200 w-full h-12"
          placeholder="e.g. 24"
          oninput="calculateEMI()" />
      </div>

    </div>
  </div>

  <!-- Result Card â€” hidden until user types -->
  <div id="emi-result" class="hidden space-y-3">

    <!-- Monthly EMI highlight -->
    <div class="rounded-3xl p-5 text-white" style="background: linear-gradient(135deg, #3B25C1, #7c3aed)">
      <p class="text-white/60 text-xs mb-1">Monthly Payment (EMI)</p>
      <h2 class="text-3xl font-black">à§³<span id="emi-monthly">0</span></h2>
    </div>

    <!-- Summary grid -->
    <div class="grid grid-cols-2 gap-3">
      <div class="card bg-base-100 rounded-2xl p-4">
        <p class="text-xs text-gray-400">Total Payment</p>
        <p class="font-black text-lg mt-1">à§³<span id="emi-total">0</span></p>
      </div>
      <div class="card bg-red-50 rounded-2xl p-4">
        <p class="text-xs text-red-400">Total Interest</p>
        <p class="font-black text-lg text-red-500 mt-1">à§³<span id="emi-interest">0</span></p>
      </div>
    </div>

    <!-- Visual interest bar -->
    <div class="card bg-base-100 rounded-2xl p-4">
      <p class="text-sm font-semibold mb-2">Principal vs Interest</p>
      <div class="flex rounded-full overflow-hidden h-4 mb-2">
        <div id="emi-bar-principal" class="bg-[#3B25C1] transition-all duration-700" style="width:50%"></div>
        <div id="emi-bar-interest"  class="bg-red-400 transition-all duration-700"  style="width:50%"></div>
      </div>
      <div class="flex justify-between text-xs text-gray-400">
        <span class="flex items-center gap-1">
          <span class="w-2 h-2 rounded-full bg-[#3B25C1] inline-block"></span>Principal
        </span>
        <span class="flex items-center gap-1">
          <span class="w-2 h-2 rounded-full bg-red-400 inline-block"></span>Interest
        </span>
      </div>
    </div>

  </div><!-- end #emi-result -->
</section>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     LUCKY SPIN SECTION
     Spin once per day to win a random bonus.
     Uses a CSS animated wheel â€” no canvas needed.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="sec-spin" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-1">Lucky Spin</h1>
  <p class="text-neutral/40 text-xs mb-5">Spin once a day for a chance to win!</p>

  <!-- The wheel is a coloured circle with a pointer -->
  <div class="flex flex-col items-center mb-6">

    <!-- Pointer arrow sitting above the wheel -->
    <div class="text-3xl mb-1" style="line-height:1">â–¼</div>

    <!-- Wheel container â€” rotation is applied here by JS -->
    <div id="spin-wheel"
      class="relative w-64 h-64 rounded-full border-4 border-white shadow-2xl overflow-hidden"
      style="transition: transform 4s cubic-bezier(0.17,0.67,0.12,1);">
      <!-- Segments are drawn as conic-gradient background -->
    </div>

    <!-- Labels overlay (shows prize text around the wheel) -->
    <div id="spin-labels" class="relative w-64" style="margin-top:-272px; height:272px; pointer-events:none;"></div>

  </div>

  <!-- Spin Button -->
  <div class="flex flex-col items-center gap-3">
    <button id="spin-btn" onclick="doSpin()"
      class="btn bg-pink-500 hover:bg-pink-600 text-white border-none rounded-2xl h-14 px-10 text-lg font-bold shadow-lg">
      ğŸ° Spin!
    </button>
    <p id="spin-status" class="text-sm text-gray-400 text-center"></p>
  </div>
</section>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     NOTES / MEMO SECTION
     Simple sticky-note style personal memos.
     Saved to localStorage. Color-coded.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="sec-notes" class="hidden w-11/12 mx-auto py-5">
  <h1 class="font-bold text-2xl mb-1">My Notes</h1>
  <p class="text-neutral/40 text-xs mb-4">Personal memos &amp; reminders</p>

  <!-- Add note card -->
  <div class="card bg-base-100 rounded-2xl mb-4">
    <div class="card-body gap-3">

      <input id="note-title" type="text" maxlength="50"
        class="input rounded-2xl bg-base-200 w-full h-11"
        placeholder="Note title (e.g. Pay electricity bill)" />

      <textarea id="note-body" maxlength="300" rows="3"
        class="textarea rounded-2xl bg-base-200 w-full resize-none"
        placeholder="Details..."></textarea>

      <!-- Color picker -->
      <div>
        <p class="text-xs font-semibold text-gray-400 mb-2">Pick a colour</p>
        <div class="flex gap-2">
          <button onclick="setNoteColor('yellow')"  id="nc-yellow"  class="note-color-btn w-7 h-7 rounded-full bg-yellow-300 ring-2 ring-yellow-400"></button>
          <button onclick="setNoteColor('green')"   id="nc-green"   class="note-color-btn w-7 h-7 rounded-full bg-green-300"></button>
          <button onclick="setNoteColor('blue')"    id="nc-blue"    class="note-color-btn w-7 h-7 rounded-full bg-blue-300"></button>
          <button onclick="setNoteColor('pink')"    id="nc-pink"    class="note-color-btn w-7 h-7 rounded-full bg-pink-300"></button>
          <button onclick="setNoteColor('purple')"  id="nc-purple"  class="note-color-btn w-7 h-7 rounded-full bg-purple-300"></button>
        </div>
      </div>

      <button onclick="addNote()"
        class="btn bg-amber-400 hover:bg-amber-500 text-white border-none rounded-2xl h-11 font-semibold">
        <i class="fa-solid fa-plus mr-2"></i>Add Note
      </button>

    </div>
  </div>

  <!-- Notes list rendered by JS -->
  <div id="notes-list" class="space-y-3"></div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     TRANSPORT & TRAVEL HUB
     8 sub-features accessible via a tab bar inside
     this single section. No page navigation needed.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="sec-transport" class="hidden w-11/12 mx-auto py-5">

  <h1 class="font-bold text-2xl mb-1">Transport & Travel</h1>
  <p class="text-neutral/40 text-xs mb-4">Manage all your travel expenses</p>

  <!-- â”€â”€ Inner tab bar (scrollable) â”€â”€ -->
  <div class="flex gap-2 overflow-x-auto pb-2 mb-4">
    <button onclick="setTransportTab('buspass')"   id="ttab-buspass"   class="ttab-btn btn btn-sm rounded-xl bg-[#3B25C1] text-white border-none shrink-0">ğŸšŒ Bus Pass</button>
    <button onclick="setTransportTab('rideshare')" id="ttab-rideshare" class="ttab-btn btn btn-sm rounded-xl bg-base-200 border-none shrink-0">ğŸ›µ Ride Share</button>
    <button onclick="setTransportTab('fuel')"      id="ttab-fuel"      class="ttab-btn btn btn-sm rounded-xl bg-base-200 border-none shrink-0">â›½ Fuel</button>
    <button onclick="setTransportTab('travelfund')" id="ttab-travelfund" class="ttab-btn btn btn-sm rounded-xl bg-base-200 border-none shrink-0">âœˆï¸ Travel Fund</button>
    <button onclick="setTransportTab('hotel')"     id="ttab-hotel"     class="ttab-btn btn btn-sm rounded-xl bg-base-200 border-none shrink-0">ğŸ¨ Hotel</button>
    <button onclick="setTransportTab('flight')"    id="ttab-flight"    class="ttab-btn btn btn-sm rounded-xl bg-base-200 border-none shrink-0">ğŸ›« Flights</button>
    <button onclick="setTransportTab('toll')"      id="ttab-toll"      class="ttab-btn btn btn-sm rounded-xl bg-base-200 border-none shrink-0">ğŸ›£ï¸ Toll</button>
    <button onclick="setTransportTab('parking')"   id="ttab-parking"   class="ttab-btn btn btn-sm rounded-xl bg-base-200 border-none shrink-0">ğŸ…¿ï¸ Parking</button>
  </div>

  <!-- â•â• 1. BUS PASS TOP-UP â•â• -->
  <div id="tp-buspass">
    <div class="card bg-base-100 rounded-2xl mb-3"><div class="card-body gap-3">
      <p class="font-bold">Bus Pass Top-up</p>
      <p class="text-xs text-neutral/50">Recharge your prepaid transport card</p>
      <div>
        <label class="label font-semibold text-sm">Transport Service</label>
        <select id="bus-service" class="select rounded-2xl bg-base-200 w-full h-12">
          <option disabled selected>Select service</option>
          <option>BRTC Bus</option>
          <option>Dhaka BRT</option>
          <option>City Bus (DSCC)</option>
          <option>Chattogram City Bus</option>
          <option>Sylhet City Bus</option>
        </select>
      </div>
      <div>
        <label class="label font-semibold text-sm">Card Number</label>
        <input id="bus-card" type="text" maxlength="16"
          class="input rounded-2xl bg-base-200 w-full h-12" placeholder="16-digit transport card number"/>
      </div>
      <!-- Quick top-up amounts -->
      <div>
        <label class="label font-semibold text-sm">Quick Amounts</label>
        <div class="grid grid-cols-4 gap-2">
          <button onclick="setBusAmount(50)"  class="btn btn-sm rounded-xl bg-base-200 border-none font-bold">à§³50</button>
          <button onclick="setBusAmount(100)" class="btn btn-sm rounded-xl bg-base-200 border-none font-bold">à§³100</button>
          <button onclick="setBusAmount(200)" class="btn btn-sm rounded-xl bg-base-200 border-none font-bold">à§³200</button>
          <button onclick="setBusAmount(500)" class="btn btn-sm rounded-xl bg-base-200 border-none font-bold">à§³500</button>
        </div>
      </div>
      <div>
        <label class="label font-semibold text-sm">Amount (BDT)</label>
        <input id="bus-amount" type="number" min="10"
          class="input rounded-2xl bg-base-200 w-full h-12" placeholder="Or type custom amount"/>
      </div>
      <div>
        <label class="label font-semibold text-sm">4-Digit PIN</label>
        <input id="bus-pin" type="password" maxlength="4"
          class="input rounded-2xl bg-base-200 w-full h-12" placeholder="PIN"/>
      </div>
      <button onclick="doBusTopup()"
        class="btn bg-sky-500 hover:bg-sky-600 text-white border-none rounded-2xl h-12 font-semibold">
        <i class="fa-solid fa-bus mr-2"></i>Top-up Card
      </button>
    </div></div>
    <!-- History -->
    <div class="card bg-base-100 rounded-2xl"><div class="card-body py-3 px-4">
      <p class="font-bold text-sm mb-2">Top-up History</p>
      <div id="bus-history" class="space-y-2"></div>
    </div></div>
  </div>

  <!-- â•â• 2. RIDE SHARE BUDGET â•â• -->
  <div id="tp-rideshare" class="hidden">
    <!-- Monthly summary cards -->
    <div class="grid grid-cols-2 gap-3 mb-3">
      <div class="rounded-2xl p-4" style="background:linear-gradient(135deg,#f97316,#fb923c)">
        <p class="text-white/70 text-xs">This Month</p>
        <p class="text-white font-black text-xl mt-1">à§³<span id="rs-month-total">0</span></p>
        <p class="text-white/60 text-xs mt-1"><span id="rs-month-trips">0</span> trips</p>
      </div>
      <div class="rounded-2xl p-4 bg-base-100">
        <p class="text-neutral/50 text-xs">Monthly Budget</p>
        <p class="font-black text-xl mt-1">à§³<span id="rs-budget-display">â€”</span></p>
        <button onclick="setRideBudget()" class="text-[10px] text-[#3B25C1] font-semibold mt-1">Set budget</button>
      </div>
    </div>
    <!-- Budget progress bar -->
    <div id="rs-bar-wrap" class="hidden card bg-base-100 rounded-2xl p-4 mb-3">
      <div class="flex justify-between text-xs mb-1">
        <span class="font-semibold">Budget used</span>
        <span id="rs-bar-label" class="text-gray-400"></span>
      </div>
      <div class="w-full bg-base-200 rounded-full h-2">
        <div id="rs-bar" class="h-2 rounded-full transition-all duration-500 bg-orange-400" style="width:0%"></div>
      </div>
    </div>
    <!-- Log a trip -->
    <div class="card bg-base-100 rounded-2xl mb-3"><div class="card-body gap-3">
      <p class="font-bold text-sm">Log a Trip</p>
      <div class="grid grid-cols-2 gap-2">
        <div>
          <label class="label font-semibold text-xs">Service</label>
          <select id="rs-service" class="select rounded-2xl bg-base-200 w-full h-11">
            <option>Pathao</option>
            <option>Uber</option>
            <option>Shohoz</option>
            <option>InDrive</option>
            <option>CNG / Auto</option>
            <option>Rickshaw</option>
          </select>
        </div>
        <div>
          <label class="label font-semibold text-xs">Cost (BDT)</label>
          <input id="rs-cost" type="number" min="1"
            class="input rounded-2xl bg-base-200 w-full h-11" placeholder="e.g. 120"/>
        </div>
      </div>
      <div>
        <label class="label font-semibold text-xs">Route (optional)</label>
        <input id="rs-route" type="text" maxlength="60"
          class="input rounded-2xl bg-base-200 w-full h-11" placeholder="e.g. Gulshan â†’ Dhanmondi"/>
      </div>
      <button onclick="logRideTrip()"
        class="btn bg-orange-500 hover:bg-orange-600 text-white border-none rounded-2xl h-11 font-semibold">
        <i class="fa-solid fa-motorcycle mr-2"></i>Log Trip
      </button>
    </div></div>
    <!-- Trip log list -->
    <div class="card bg-base-100 rounded-2xl"><div class="card-body py-3 px-4">
      <div class="flex justify-between items-center mb-2">
        <p class="font-bold text-sm">Trip Log</p>
        <button onclick="clearRideLog()" class="text-xs text-red-400 font-semibold">Clear all</button>
      </div>
      <div id="rs-log" class="space-y-2"></div>
    </div></div>
  </div>

  <!-- â•â• 3. FUEL COST CALCULATOR â•â• -->
  <div id="tp-fuel" class="hidden">
    <div class="card bg-base-100 rounded-2xl mb-3"><div class="card-body gap-4">
      <p class="font-bold">Fuel Cost Calculator</p>
      <div>
        <label class="label font-semibold text-sm">Fuel Type</label>
        <select id="fuel-type" class="select rounded-2xl bg-base-200 w-full h-12" onchange="calcFuel()">
          <option value="octane">Octane (à§³130/L)</option>
          <option value="petrol">Petrol (à§³125/L)</option>
          <option value="diesel">Diesel (à§³109/L)</option>
          <option value="cng">CNG (à§³43/mÂ³)</option>
        </select>
      </div>
      <div class="grid grid-cols-2 gap-3">
        <div>
          <label class="label font-semibold text-sm">Distance (km)</label>
          <input id="fuel-distance" type="number" min="0" step="0.1"
            class="input rounded-2xl bg-base-200 w-full h-12"
            placeholder="e.g. 50" oninput="calcFuel()"/>
        </div>
        <div>
          <label class="label font-semibold text-sm">Mileage (km/L)</label>
          <input id="fuel-mileage" type="number" min="0" step="0.1"
            class="input rounded-2xl bg-base-200 w-full h-12"
            placeholder="e.g. 15" oninput="calcFuel()"/>
        </div>
      </div>
      <!-- Live result -->
      <div id="fuel-result" class="hidden rounded-2xl p-4" style="background:linear-gradient(135deg,#f59e0b,#fbbf24)">
        <p class="text-white/80 text-xs mb-1">Estimated Fuel Cost</p>
        <p class="text-white font-black text-3xl">à§³<span id="fuel-cost">0</span></p>
        <div class="flex gap-4 mt-2 text-white/70 text-xs">
          <span>Fuel needed: <span id="fuel-litres" class="font-bold text-white"></span>L</span>
          <span>Per km: <span id="fuel-per-km" class="font-bold text-white"></span></span>
        </div>
      </div>
      <!-- Fuel prices reference -->
      <div class="text-xs text-gray-400 text-center">Prices based on BPC rates (April 2024)</div>
    </div></div>
    <!-- Trip cost log -->
    <div class="card bg-base-100 rounded-2xl"><div class="card-body gap-3">
      <p class="font-bold text-sm">Save This Trip</p>
      <input id="fuel-trip-name" type="text" maxlength="40"
        class="input rounded-2xl bg-base-200 w-full h-11" placeholder="Trip name e.g. Dhaka to Sylhet"/>
      <button onclick="saveFuelTrip()"
        class="btn bg-amber-500 hover:bg-amber-600 text-white border-none rounded-2xl h-11 font-semibold">
        <i class="fa-solid fa-floppy-disk mr-2"></i>Save Trip
      </button>
      <div id="fuel-history" class="space-y-2 mt-1"></div>
    </div></div>
  </div>

  <!-- â•â• 4. TRAVEL FUND â•â• -->
  <div id="tp-travelfund" class="hidden">
    <!-- Add new travel fund -->
    <div class="card bg-base-100 rounded-2xl mb-3"><div class="card-body gap-3">
      <p class="font-bold text-sm">Create a Travel Fund</p>
      <div class="grid grid-cols-2 gap-2">
        <div>
          <label class="label font-semibold text-xs">Destination</label>
          <input id="tf-dest" type="text" maxlength="30"
            class="input rounded-2xl bg-base-200 w-full h-11" placeholder="e.g. Cox's Bazar"/>
        </div>
        <div>
          <label class="label font-semibold text-xs">Target (BDT)</label>
          <input id="tf-target" type="number" min="1"
            class="input rounded-2xl bg-base-200 w-full h-11" placeholder="e.g. 20000"/>
        </div>
      </div>
      <div>
        <label class="label font-semibold text-xs">Trip Date (optional)</label>
        <input id="tf-date" type="date"
          class="input rounded-2xl bg-base-200 w-full h-11"/>
      </div>
      <button onclick="addTravelFund()"
        class="btn bg-[#3B25C1] text-white border-none rounded-2xl h-11 font-semibold">
        <i class="fa-solid fa-plane-departure mr-2"></i>Create Fund
      </button>
    </div></div>
    <!-- Funds list -->
    <div id="tf-list" class="space-y-3"></div>
  </div>

  <!-- Deposit to Travel Fund modal -->
  <dialog id="tf-deposit-modal" class="modal">
    <div class="modal-box rounded-3xl">
      <h3 class="font-bold text-lg mb-1">Add to Fund</h3>
      <p id="tf-modal-name" class="text-neutral/50 text-sm mb-4"></p>
      <input id="tf-deposit-amount" type="number" min="1"
        class="input rounded-2xl bg-base-200 w-full h-11 mb-2" placeholder="Amount to add (BDT)"/>
      <input id="tf-deposit-pin" type="password" maxlength="4"
        class="input rounded-2xl bg-base-200 w-full h-11" placeholder="4-digit PIN"/>
      <div class="modal-action gap-3 mt-4">
        <button onclick="document.getElementById('tf-deposit-modal').close()" class="btn rounded-2xl flex-1">Cancel</button>
        <button onclick="depositTravelFund()" class="btn bg-[#3B25C1] text-white border-none rounded-2xl flex-1">Add Money</button>
      </div>
    </div>
  </dialog>

  <!-- â•â• 5. HOTEL BOOKING BUDGET â•â• -->
  <div id="tp-hotel" class="hidden">
    <div class="card bg-base-100 rounded-2xl mb-3"><div class="card-body gap-3">
      <p class="font-bold text-sm">Set Hotel Budget</p>
      <div>
        <label class="label font-semibold text-sm">Hotel / Location</label>
        <input id="hotel-name" type="text" maxlength="40"
          class="input rounded-2xl bg-base-200 w-full h-12" placeholder="e.g. Cox's Bazar Seagull Hotel"/>
      </div>
      <div class="grid grid-cols-2 gap-2">
        <div>
          <label class="label font-semibold text-xs">Check-in</label>
          <input id="hotel-checkin" type="date" class="input rounded-2xl bg-base-200 w-full h-11" onchange="calcHotelCost()"/>
        </div>
        <div>
          <label class="label font-semibold text-xs">Check-out</label>
          <input id="hotel-checkout" type="date" class="input rounded-2xl bg-base-200 w-full h-11" onchange="calcHotelCost()"/>
        </div>
      </div>
      <div>
        <label class="label font-semibold text-sm">Price per Night (BDT)</label>
        <input id="hotel-rate" type="number" min="1"
          class="input rounded-2xl bg-base-200 w-full h-12"
          placeholder="e.g. 3500" oninput="calcHotelCost()"/>
      </div>
      <!-- Live cost preview -->
      <div id="hotel-preview" class="hidden rounded-2xl bg-sky-50 p-4 text-center">
        <p class="text-sky-600 text-xs font-semibold"><span id="hotel-nights">0</span> nights</p>
        <p class="text-sky-700 font-black text-2xl mt-1">à§³<span id="hotel-total">0</span></p>
      </div>
      <button onclick="saveHotelBudget()"
        class="btn bg-sky-600 hover:bg-sky-700 text-white border-none rounded-2xl h-12 font-semibold">
        <i class="fa-solid fa-hotel mr-2"></i>Save Budget
      </button>
    </div></div>
    <!-- Saved hotel budgets -->
    <div class="card bg-base-100 rounded-2xl"><div class="card-body py-3 px-4">
      <p class="font-bold text-sm mb-2">Saved Hotel Budgets</p>
      <div id="hotel-list" class="space-y-3"></div>
    </div></div>
  </div>

  <!-- â•â• 6. FLIGHT PRICE TRACKER â•â• -->
  <div id="tp-flight" class="hidden">
    <div class="card bg-base-100 rounded-2xl mb-3"><div class="card-body gap-3">
      <p class="font-bold text-sm">Track a Flight Route</p>
      <div class="grid grid-cols-2 gap-2">
        <div>
          <label class="label font-semibold text-xs">From</label>
          <select id="flight-from" class="select rounded-2xl bg-base-200 w-full h-11">
            <option>DAC â€” Dhaka</option>
            <option>CGP â€” Chittagong</option>
            <option>ZYL â€” Sylhet</option>
            <option>JSR â€” Jessore</option>
            <option>RJH â€” Rajshahi</option>
            <option>BZL â€” Barisal</option>
          </select>
        </div>
        <div>
          <label class="label font-semibold text-xs">To</label>
          <select id="flight-to" class="select rounded-2xl bg-base-200 w-full h-11">
            <option>CGP â€” Chittagong</option>
            <option>DAC â€” Dhaka</option>
            <option>ZYL â€” Sylhet</option>
            <option>DXB â€” Dubai</option>
            <option>KUL â€” Kuala Lumpur</option>
            <option>DOH â€” Doha</option>
            <option>RUH â€” Riyadh</option>
            <option>BKK â€” Bangkok</option>
            <option>SIN â€” Singapore</option>
            <option>DEL â€” Delhi</option>
          </select>
        </div>
      </div>
      <div class="grid grid-cols-2 gap-2">
        <div>
          <label class="label font-semibold text-xs">Travel Date</label>
          <input id="flight-date" type="date" class="input rounded-2xl bg-base-200 w-full h-11"/>
        </div>
        <div>
          <label class="label font-semibold text-xs">Budget Alert (BDT)</label>
          <input id="flight-budget" type="number" min="1"
            class="input rounded-2xl bg-base-200 w-full h-11" placeholder="e.g. 15000"/>
        </div>
      </div>
      <button onclick="trackFlight()"
        class="btn bg-indigo-600 hover:bg-indigo-700 text-white border-none rounded-2xl h-11 font-semibold">
        <i class="fa-solid fa-plane mr-2"></i>Add to Tracker
      </button>
    </div></div>
    <!-- Tracked routes -->
    <div class="card bg-base-100 rounded-2xl"><div class="card-body py-3 px-4">
      <p class="font-bold text-sm mb-3">Tracked Routes</p>
      <div id="flight-list" class="space-y-3"></div>
    </div></div>
  </div>

  <!-- â•â• 7. TOLL FEE TRACKER â•â• -->
  <div id="tp-toll" class="hidden">
    <!-- Summary -->
    <div class="rounded-2xl p-4 mb-3 text-white" style="background:linear-gradient(135deg,#475569,#64748b)">
      <p class="text-white/70 text-xs">Total Toll Paid (This Month)</p>
      <p class="font-black text-2xl mt-1">à§³<span id="toll-month-total">0</span></p>
      <p class="text-white/60 text-xs mt-1"><span id="toll-month-count">0</span> toll stops</p>
    </div>
    <!-- Log a toll -->
    <div class="card bg-base-100 rounded-2xl mb-3"><div class="card-body gap-3">
      <p class="font-bold text-sm">Log Toll Payment</p>
      <div>
        <label class="label font-semibold text-sm">Toll Plaza / Highway</label>
        <select id="toll-plaza" class="select rounded-2xl bg-base-200 w-full h-12">
          <option disabled selected>Select toll plaza</option>
          <option>Meghna Bridge Toll</option>
          <option>Meghna-Gumti Bridge Toll</option>
          <option>Bangabandhu Bridge (Jamuna)</option>
          <option>Buriganga Bridge</option>
          <option>Dhaka Elevated Expressway</option>
          <option>Chittagong Port Toll</option>
          <option>Dhakaâ€“Chittagong Highway</option>
          <option>Dhakaâ€“Mawa Expressway</option>
          <option>Other Highway</option>
        </select>
      </div>
      <div class="grid grid-cols-2 gap-2">
        <div>
          <label class="label font-semibold text-xs">Vehicle Type</label>
          <select id="toll-vehicle" class="select rounded-2xl bg-base-200 w-full h-11">
            <option>Car / Jeep</option>
            <option>Microbus</option>
            <option>Bus</option>
            <option>Truck</option>
            <option>Motorcycle</option>
          </select>
        </div>
        <div>
          <label class="label font-semibold text-xs">Fee (BDT)</label>
          <input id="toll-amount" type="number" min="1"
            class="input rounded-2xl bg-base-200 w-full h-11" placeholder="e.g. 100"/>
        </div>
      </div>
      <button onclick="logToll()"
        class="btn bg-slate-600 hover:bg-slate-700 text-white border-none rounded-2xl h-11 font-semibold">
        <i class="fa-solid fa-road mr-2"></i>Log Toll
      </button>
    </div></div>
    <!-- Toll log -->
    <div class="card bg-base-100 rounded-2xl"><div class="card-body py-3 px-4">
      <div class="flex justify-between items-center mb-2">
        <p class="font-bold text-sm">Toll History</p>
        <button onclick="clearTollLog()" class="text-xs text-red-400 font-semibold">Clear</button>
      </div>
      <div id="toll-log" class="space-y-2"></div>
    </div></div>
  </div>

  <!-- â•â• 8. PARKING FEE LOG â•â• -->
  <div id="tp-parking" class="hidden">
    <!-- Summary -->
    <div class="grid grid-cols-2 gap-3 mb-3">
      <div class="rounded-2xl p-4 bg-violet-600 text-white">
        <p class="text-white/70 text-xs">This Month</p>
        <p class="font-black text-xl mt-1">à§³<span id="park-month-total">0</span></p>
      </div>
      <div class="rounded-2xl p-4 bg-base-100">
        <p class="text-neutral/50 text-xs">Total Logged</p>
        <p class="font-black text-xl mt-1">à§³<span id="park-all-total">0</span></p>
      </div>
    </div>
    <!-- Log parking -->
    <div class="card bg-base-100 rounded-2xl mb-3"><div class="card-body gap-3">
      <p class="font-bold text-sm">Log Parking Fee</p>
      <div>
        <label class="label font-semibold text-sm">Location</label>
        <input id="park-location" type="text" maxlength="50"
          class="input rounded-2xl bg-base-200 w-full h-12" placeholder="e.g. Bashundhara City Parking"/>
      </div>
      <div class="grid grid-cols-2 gap-2">
        <div>
          <label class="label font-semibold text-xs">Duration</label>
          <select id="park-duration" class="select rounded-2xl bg-base-200 w-full h-11">
            <option>< 1 hour</option>
            <option>1â€“2 hours</option>
            <option>2â€“4 hours</option>
            <option>4â€“8 hours</option>
            <option>Full day</option>
            <option>Overnight</option>
          </select>
        </div>
        <div>
          <label class="label font-semibold text-xs">Fee (BDT)</label>
          <input id="park-fee" type="number" min="1"
            class="input rounded-2xl bg-base-200 w-full h-11" placeholder="e.g. 50"/>
        </div>
      </div>
      <button onclick="logParking()"
        class="btn bg-violet-600 hover:bg-violet-700 text-white border-none rounded-2xl h-11 font-semibold">
        <i class="fa-solid fa-square-parking mr-2"></i>Log Parking
      </button>
    </div></div>
    <!-- Parking log -->
    <div class="card bg-base-100 rounded-2xl"><div class="card-body py-3 px-4">
      <div class="flex justify-between items-center mb-2">
        <p class="font-bold text-sm">Parking History</p>
        <button onclick="clearParkingLog()" class="text-xs text-red-400 font-semibold">Clear</button>
      </div>
      <div id="park-log" class="space-y-2"></div>
    </div></div>
  </div>

</section>
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FINANCE TOOLS HUB
     5 tools in one section with an inner tab bar:
     Gold/Silver | Zakat | Tax | FDR | DPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="sec-finance" class="hidden w-11/12 mx-auto py-5">

  <h1 class="font-bold text-2xl mb-1">Finance Tools</h1>
  <p class="text-neutral/40 text-xs mb-4">Calculators & trackers for your money</p>

  <!-- â”€â”€ Inner tab bar â”€â”€ -->
  <div class="flex gap-2 overflow-x-auto pb-2 mb-5">
    <button onclick="setFinanceTab('gold')"  id="ftab-gold"  class="ftab-btn btn btn-sm rounded-xl bg-[#3B25C1] text-white border-none shrink-0">ğŸ¥‡ Gold</button>
    <button onclick="setFinanceTab('zakat')" id="ftab-zakat" class="ftab-btn btn btn-sm rounded-xl bg-base-200 border-none shrink-0">â˜ªï¸ Zakat</button>
    <button onclick="setFinanceTab('tax')"   id="ftab-tax"   class="ftab-btn btn btn-sm rounded-xl bg-base-200 border-none shrink-0">ğŸ§¾ Tax</button>
    <button onclick="setFinanceTab('fdr')"   id="ftab-fdr"   class="ftab-btn btn btn-sm rounded-xl bg-base-200 border-none shrink-0">ğŸ¦ FDR</button>
    <button onclick="setFinanceTab('dps')"   id="ftab-dps"   class="ftab-btn btn btn-sm rounded-xl bg-base-200 border-none shrink-0">ğŸ’³ DPS</button>
  </div>


  <!-- â•â• 1. GOLD & SILVER PRICE TRACKER â•â• -->
  <div id="fp-gold">

    <!-- Live price cards -->
    <div class="grid grid-cols-2 gap-3 mb-4">
      <div class="rounded-2xl p-4 text-white" style="background:linear-gradient(135deg,#b45309,#d97706)">
        <p class="text-white/70 text-xs mb-1">Gold (22K) per gram</p>
        <p class="font-black text-2xl">à§³<span id="gold-22k-price">9,450</span></p>
        <p class="text-white/60 text-xs mt-1">Per bhori (11.664g): à§³<span id="gold-22k-bhori">110,221</span></p>
      </div>
      <div class="rounded-2xl p-4 text-white" style="background:linear-gradient(135deg,#92400e,#b45309)">
        <p class="text-white/70 text-xs mb-1">Gold (21K) per gram</p>
        <p class="font-black text-2xl">à§³<span id="gold-21k-price">9,020</span></p>
        <p class="text-white/60 text-xs mt-1">Per bhori (11.664g): à§³<span id="gold-21k-bhori">105,209</span></p>
      </div>
      <div class="rounded-2xl p-4 text-white" style="background:linear-gradient(135deg,#475569,#64748b)">
        <p class="text-white/70 text-xs mb-1">Silver per gram</p>
        <p class="font-black text-2xl">à§³<span id="silver-price">105</span></p>
        <p class="text-white/60 text-xs mt-1">Per bhori (11.664g): à§³<span id="silver-bhori">1,225</span></p>
      </div>
      <div class="rounded-2xl p-4 bg-base-100">
        <p class="text-neutral/50 text-xs mb-1">Gold (18K) per gram</p>
        <p class="font-black text-2xl">à§³<span id="gold-18k-price">7,730</span></p>
        <p class="text-neutral/40 text-xs mt-1">Per bhori: à§³<span id="gold-18k-bhori">90,151</span></p>
      </div>
    </div>
    <p class="text-xs text-gray-400 text-center mb-4">Prices based on Bangladesh Jewellers Association (BAJUS) rates</p>

    <!-- Gold / Silver calculator -->
    <div class="card bg-base-100 rounded-2xl mb-3"><div class="card-body gap-3">
      <p class="font-bold text-sm">Gold / Silver Calculator</p>
      <div class="grid grid-cols-2 gap-2">
        <div>
          <label class="label font-semibold text-xs">Metal & Purity</label>
          <select id="gold-calc-type" class="select rounded-2xl bg-base-200 w-full h-11" onchange="calcGold()">
            <option value="9450">Gold 22K</option>
            <option value="9020">Gold 21K</option>
            <option value="7730">Gold 18K</option>
            <option value="105">Silver</option>
          </select>
        </div>
        <div>
          <label class="label font-semibold text-xs">Unit</label>
          <select id="gold-calc-unit" class="select rounded-2xl bg-base-200 w-full h-11" onchange="calcGold()">
            <option value="1">Gram</option>
            <option value="11.664">Bhori (11.664g)</option>
            <option value="10">10 Grams</option>
          </select>
        </div>
      </div>
      <div>
        <label class="label font-semibold text-xs">Quantity</label>
        <input id="gold-qty" type="number" min="0" step="0.01"
          class="input rounded-2xl bg-base-200 w-full h-11"
          placeholder="e.g. 5" oninput="calcGold()"/>
      </div>
      <!-- Result -->
      <div id="gold-result" class="hidden rounded-2xl bg-yellow-50 border border-yellow-200 p-4 text-center">
        <p class="text-yellow-700 text-xs font-semibold">Estimated Value</p>
        <p class="text-yellow-800 font-black text-3xl mt-1">à§³<span id="gold-value">0</span></p>
      </div>
    </div></div>

    <!-- Price alert -->
    <div class="card bg-base-100 rounded-2xl"><div class="card-body gap-3">
      <p class="font-bold text-sm">Price Alert</p>
      <p class="text-xs text-neutral/50">Get notified when gold price goes above or below your target</p>
      <div class="grid grid-cols-2 gap-2">
        <div>
          <label class="label font-semibold text-xs">Alert Type</label>
          <select id="gold-alert-type" class="select rounded-2xl bg-base-200 w-full h-11">
            <option value="above">Above (à§³/gram)</option>
            <option value="below">Below (à§³/gram)</option>
          </select>
        </div>
        <div>
          <label class="label font-semibold text-xs">Target Price (à§³)</label>
          <input id="gold-alert-price" type="number" min="1"
            class="input rounded-2xl bg-base-200 w-full h-11" placeholder="e.g. 10000"/>
        </div>
      </div>
      <button onclick="setGoldAlert()"
        class="btn bg-yellow-600 hover:bg-yellow-700 text-white border-none rounded-2xl h-11 font-semibold">
        <i class="fa-solid fa-bell mr-2"></i>Set Alert
      </button>
      <div id="gold-alerts-list" class="space-y-2"></div>
    </div></div>
  </div><!-- end fp-gold -->


  <!-- â•â• 2. ZAKAT CALCULATOR â•â• -->
  <div id="fp-zakat" class="hidden">

    <!-- Nisab info banner -->
    <div class="rounded-2xl p-4 mb-4 bg-emerald-50 border border-emerald-200">
      <p class="font-bold text-emerald-800 text-sm">ğŸ“– Nisab Threshold (2024)</p>
      <div class="grid grid-cols-2 gap-2 mt-2 text-xs text-emerald-700">
        <div>ğŸ¥‡ Gold Nisab (87.48g): <span class="font-bold">à§³8,27,586</span></div>
        <div>ğŸª™ Silver Nisab (612.36g): <span class="font-bold">à§³64,298</span></div>
      </div>
      <p class="text-xs text-emerald-600 mt-2">Zakat rate: <span class="font-bold">2.5%</span> of total qualifying wealth</p>
    </div>

    <!-- Wealth inputs -->
    <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-3">
      <p class="font-bold text-sm">Enter Your Assets</p>

      <div>
        <label class="label font-semibold text-xs">ğŸ’° Cash & Bank Balance (BDT)</label>
        <input id="zk-cash" type="number" min="0"
          class="input rounded-2xl bg-base-200 w-full h-11"
          placeholder="e.g. 500000" oninput="calcZakat()"/>
      </div>
      <div>
        <label class="label font-semibold text-xs">ğŸ¥‡ Gold Value (BDT)</label>
        <input id="zk-gold" type="number" min="0"
          class="input rounded-2xl bg-base-200 w-full h-11"
          placeholder="Current market value" oninput="calcZakat()"/>
      </div>
      <div>
        <label class="label font-semibold text-xs">ğŸª™ Silver Value (BDT)</label>
        <input id="zk-silver" type="number" min="0"
          class="input rounded-2xl bg-base-200 w-full h-11"
          placeholder="Current market value" oninput="calcZakat()"/>
      </div>
      <div>
        <label class="label font-semibold text-xs">ğŸ“¦ Business / Stock Value (BDT)</label>
        <input id="zk-business" type="number" min="0"
          class="input rounded-2xl bg-base-200 w-full h-11"
          placeholder="Inventory, investments etc." oninput="calcZakat()"/>
      </div>
      <div>
        <label class="label font-semibold text-xs">ğŸ’³ Money Owed TO You (BDT)</label>
        <input id="zk-receivable" type="number" min="0"
          class="input rounded-2xl bg-base-200 w-full h-11"
          placeholder="Loans given to others" oninput="calcZakat()"/>
      </div>
      <div>
        <label class="label font-semibold text-xs">â– Debts / Liabilities (BDT)</label>
        <input id="zk-debts" type="number" min="0"
          class="input rounded-2xl bg-base-200 w-full h-11"
          placeholder="What you owe others" oninput="calcZakat()"/>
      </div>
    </div></div>

    <!-- Zakat result -->
    <div id="zakat-result" class="hidden space-y-3">
      <div class="rounded-2xl p-5 text-white" style="background:linear-gradient(135deg,#059669,#10b981)">
        <p class="text-white/70 text-xs mb-1">Your Zakat Due</p>
        <p class="font-black text-4xl">à§³<span id="zk-due">0</span></p>
        <p class="text-white/60 text-xs mt-2">Net Zakatable Wealth: à§³<span id="zk-net">0</span></p>
      </div>
      <div id="zakat-eligible-msg" class="rounded-2xl p-4 bg-base-100 text-sm text-center font-semibold"></div>
    </div>
    <div id="zakat-below-nisab" class="hidden rounded-2xl bg-orange-50 border border-orange-200 p-4 text-center text-sm text-orange-700 font-semibold">
      â„¹ï¸ Your wealth is below the Nisab threshold â€” Zakat is not yet obligatory.
    </div>

  </div><!-- end fp-zakat -->


  <!-- â•â• 3. TAX / INCOME CALCULATOR â•â• -->
  <div id="fp-tax" class="hidden">

    <!-- Tax year note -->
    <div class="rounded-2xl p-3 mb-4 bg-blue-50 border border-blue-200 text-xs text-blue-700">
      ğŸ“‹ Based on Bangladesh National Budget FY 2023â€“24 tax slabs for individual taxpayers
    </div>

    <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-3">
      <p class="font-bold text-sm">Income Details</p>

      <div>
        <label class="label font-semibold text-xs">Taxpayer Category</label>
        <select id="tax-category" class="select rounded-2xl bg-base-200 w-full h-12" onchange="calcTax()">
          <option value="general">General (Male)</option>
          <option value="female">Female / 65+ / Disabled</option>
          <option value="freedom">Freedom Fighter</option>
        </select>
      </div>

      <div>
        <label class="label font-semibold text-xs">Annual Income (BDT)</label>
        <input id="tax-income" type="number" min="0"
          class="input rounded-2xl bg-base-200 w-full h-12"
          placeholder="Total yearly income" oninput="calcTax()"/>
      </div>

      <div>
        <label class="label font-semibold text-xs">Investment Rebate (BDT) â€” optional</label>
        <input id="tax-invest" type="number" min="0"
          class="input rounded-2xl bg-base-200 w-full h-12"
          placeholder="DPS, insurance, savings bond etc." oninput="calcTax()"/>
      </div>
    </div></div>

    <!-- Tax result -->
    <div id="tax-result" class="hidden space-y-3">
      <div class="rounded-2xl p-5 text-white" style="background:linear-gradient(135deg,#1d4ed8,#3b82f6)">
        <p class="text-white/70 text-xs mb-1">Estimated Income Tax</p>
        <p class="font-black text-4xl">à§³<span id="tax-due">0</span></p>
        <p class="text-white/60 text-xs mt-2">After investment rebate: à§³<span id="tax-after-rebate">0</span></p>
      </div>
      <!-- Slab breakdown -->
      <div class="card bg-base-100 rounded-2xl p-4">
        <p class="font-bold text-sm mb-3">Tax Slab Breakdown</p>
        <div id="tax-slabs" class="space-y-2"></div>
      </div>
      <div class="card bg-base-100 rounded-2xl p-4 space-y-1 text-sm">
        <div class="flex justify-between"><span class="text-gray-400">Gross Tax</span><span id="tax-gross" class="font-bold"></span></div>
        <div class="flex justify-between"><span class="text-gray-400">Investment Rebate (15%)</span><span id="tax-rebate-amt" class="font-bold text-green-600"></span></div>
        <div class="flex justify-between border-t border-base-200 pt-1 mt-1"><span class="font-bold">Net Tax Payable</span><span id="tax-net" class="font-black text-blue-600"></span></div>
        <div class="flex justify-between"><span class="text-gray-400">Monthly Equivalent</span><span id="tax-monthly" class="font-bold text-gray-500"></span></div>
      </div>
    </div>

  </div><!-- end fp-tax -->


  <!-- â•â• 4. FDR CALCULATOR â•â• -->
  <div id="fp-fdr" class="hidden">

    <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-4">
      <p class="font-bold">Fixed Deposit (FDR) Calculator</p>
      <p class="text-xs text-neutral/50">Calculate your FDR maturity amount and interest earned</p>

      <div>
        <label class="label font-semibold text-sm">Bank / Institution</label>
        <select id="fdr-bank" class="select rounded-2xl bg-base-200 w-full h-12" onchange="updateFDRRate()">
          <option value="7.5">Sonali Bank (7.50%)</option>
          <option value="8.0">Janata Bank (8.00%)</option>
          <option value="8.5">Dutch-Bangla Bank (8.50%)</option>
          <option value="9.0">BRAC Bank (9.00%)</option>
          <option value="9.5">Islami Bank (9.50%)</option>
          <option value="10.0">Al-Arafah Islami Bank (10.00%)</option>
          <option value="custom">Custom Rate</option>
        </select>
      </div>

      <!-- Custom rate input â€” shown only when "Custom" is selected -->
      <div id="fdr-custom-wrap" class="hidden">
        <label class="label font-semibold text-sm">Custom Interest Rate (%)</label>
        <input id="fdr-custom-rate" type="number" min="0" step="0.01"
          class="input rounded-2xl bg-base-200 w-full h-12"
          placeholder="e.g. 8.75" oninput="calcFDR()"/>
      </div>

      <div>
        <label class="label font-semibold text-sm">Principal Amount (BDT)</label>
        <input id="fdr-principal" type="number" min="1"
          class="input rounded-2xl bg-base-200 w-full h-12"
          placeholder="e.g. 100000" oninput="calcFDR()"/>
      </div>

      <div>
        <label class="label font-semibold text-sm">Term</label>
        <select id="fdr-term" class="select rounded-2xl bg-base-200 w-full h-12" onchange="calcFDR()">
          <option value="3">3 Months</option>
          <option value="6">6 Months</option>
          <option value="12" selected>1 Year</option>
          <option value="24">2 Years</option>
          <option value="36">3 Years</option>
          <option value="60">5 Years</option>
        </select>
      </div>

      <div>
        <label class="label font-semibold text-sm">Interest Type</label>
        <select id="fdr-compound" class="select rounded-2xl bg-base-200 w-full h-12" onchange="calcFDR()">
          <option value="simple">Simple Interest</option>
          <option value="quarterly">Compounded Quarterly</option>
          <option value="monthly">Compounded Monthly</option>
        </select>
      </div>
    </div></div>

    <!-- FDR Result -->
    <div id="fdr-result" class="hidden space-y-3">
      <div class="rounded-2xl p-5 text-white" style="background:linear-gradient(135deg,#7c3aed,#3B25C1)">
        <p class="text-white/70 text-xs mb-1">Maturity Amount</p>
        <p class="font-black text-4xl">à§³<span id="fdr-maturity">0</span></p>
        <p class="text-white/60 text-xs mt-2">Interest Earned: à§³<span id="fdr-interest">0</span></p>
      </div>
      <div class="grid grid-cols-3 gap-2 text-center">
        <div class="card bg-base-100 rounded-2xl p-3">
          <p class="text-xs text-gray-400">Principal</p>
          <p class="font-black text-sm mt-1">à§³<span id="fdr-p-display">0</span></p>
        </div>
        <div class="card bg-base-100 rounded-2xl p-3">
          <p class="text-xs text-gray-400">Rate</p>
          <p class="font-black text-sm mt-1"><span id="fdr-rate-display">0</span>%</p>
        </div>
        <div class="card bg-base-100 rounded-2xl p-3">
          <p class="text-xs text-gray-400">Term</p>
          <p class="font-black text-sm mt-1"><span id="fdr-term-display">0</span>mo</p>
        </div>
      </div>
    </div>

  </div><!-- end fp-fdr -->


  <!-- â•â• 5. DPS CALCULATOR â•â• -->
  <div id="fp-dps" class="hidden">

    <div class="card bg-base-100 rounded-2xl mb-4"><div class="card-body gap-4">
      <p class="font-bold">DPS / Monthly Savings Calculator</p>
      <p class="text-xs text-neutral/50">Calculate total savings and returns from a monthly DPS scheme</p>

      <div>
        <label class="label font-semibold text-sm">Bank / Scheme</label>
        <select id="dps-bank" class="select rounded-2xl bg-base-200 w-full h-12" onchange="updateDPSRate()">
          <option value="7.0">Sonali Bank DPS (7.00%)</option>
          <option value="7.5">Agrani Bank DPS (7.50%)</option>
          <option value="8.0">DBBL DPS (8.00%)</option>
          <option value="8.5">BRAC Bank DPS (8.50%)</option>
          <option value="9.0">Islami Bank MDS (9.00%)</option>
          <option value="9.5">Al-Arafah DPS (9.50%)</option>
          <option value="custom">Custom Rate</option>
        </select>
      </div>

      <div id="dps-custom-wrap" class="hidden">
        <label class="label font-semibold text-sm">Custom Interest Rate (%)</label>
        <input id="dps-custom-rate" type="number" min="0" step="0.01"
          class="input rounded-2xl bg-base-200 w-full h-12"
          placeholder="e.g. 8.25" oninput="calcDPS()"/>
      </div>

      <div>
        <label class="label font-semibold text-sm">Monthly Deposit (BDT)</label>
        <input id="dps-monthly" type="number" min="1"
          class="input rounded-2xl bg-base-200 w-full h-12"
          placeholder="e.g. 5000" oninput="calcDPS()"/>
      </div>

      <div>
        <label class="label font-semibold text-sm">Tenure</label>
        <select id="dps-tenure" class="select rounded-2xl bg-base-200 w-full h-12" onchange="calcDPS()">
          <option value="12">1 Year (12 months)</option>
          <option value="24">2 Years (24 months)</option>
          <option value="36">3 Years (36 months)</option>
          <option value="60">5 Years (60 months)</option>
          <option value="120">10 Years (120 months)</option>
        </select>
      </div>
    </div></div>

    <!-- DPS Result -->
    <div id="dps-result" class="hidden space-y-3">
      <div class="rounded-2xl p-5 text-white" style="background:linear-gradient(135deg,#0369a1,#0ea5e9)">
        <p class="text-white/70 text-xs mb-1">Total Maturity Amount</p>
        <p class="font-black text-4xl">à§³<span id="dps-maturity">0</span></p>
        <p class="text-white/60 text-xs mt-2">Profit Earned: à§³<span id="dps-profit">0</span></p>
      </div>
      <div class="grid grid-cols-2 gap-3">
        <div class="card bg-base-100 rounded-2xl p-4 text-center">
          <p class="text-xs text-gray-400">Total Deposited</p>
          <p class="font-black text-lg mt-1">à§³<span id="dps-total-deposited">0</span></p>
        </div>
        <div class="card bg-green-50 rounded-2xl p-4 text-center">
          <p class="text-xs text-green-600">Total Profit</p>
          <p class="font-black text-lg text-green-600 mt-1">à§³<span id="dps-total-profit">0</span></p>
        </div>
      </div>
      <!-- Year-by-year breakdown -->
      <div class="card bg-base-100 rounded-2xl p-4">
        <p class="font-bold text-sm mb-3">Yearly Breakdown</p>
        <div id="dps-breakdown" class="space-y-2"></div>
      </div>
    </div>

  </div><!-- end fp-dps -->

</section>

</main>

<!-- â•â•â• BOTTOM NAV â•â•â• -->
<nav class="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-md bg-base-100 border-t border-base-300 z-20">
  <div class="flex justify-around py-2">
    <button onclick="setNav('home')" id="nav-home" class="nav-item flex flex-col items-center gap-0.5 px-3 py-1 rounded-xl">
      <i class="fa-solid fa-house text-lg text-gray-400"></i>
      <p class="text-[10px] text-gray-400 font-medium">Home</p>
    </button>
    <button onclick="setNav('send')" id="nav-send" class="nav-item flex flex-col items-center gap-0.5 px-3 py-1 rounded-xl">
      <i class="fa-solid fa-paper-plane text-lg text-gray-400"></i>
      <p class="text-[10px] text-gray-400 font-medium">Send</p>
    </button>
    <button onclick="setNav('dashboard')" id="nav-dashboard" class="nav-item flex flex-col items-center gap-0.5 px-3 py-1 rounded-xl">
      <i class="fa-solid fa-chart-line text-lg text-gray-400"></i>
      <p class="text-[10px] text-gray-400 font-medium">Stats</p>
    </button>
    <button onclick="setNav('history')" id="nav-history" class="nav-item flex flex-col items-center gap-0.5 px-3 py-1 rounded-xl relative">
      <i class="fa-solid fa-clock-rotate-left text-lg text-gray-400"></i>
      <p class="text-[10px] text-gray-400 font-medium">History</p>
      <span id="tx-badge-nav" class="hidden absolute top-0 right-1 bg-red-500 text-white text-[9px] rounded-full w-4 h-4 flex items-center justify-center font-bold"></span>
    </button>
    <button onclick="setNav('settings')" id="nav-settings" class="nav-item flex flex-col items-center gap-0.5 px-3 py-1 rounded-xl">
      <i class="fa-solid fa-sliders text-lg text-gray-400"></i>
      <p class="text-[10px] text-gray-400 font-medium">Settings</p>
    </button>
  </div>
</nav>

<!-- Logout Modal -->
<dialog id="logout-modal" class="modal">
  <div class="modal-box rounded-3xl">
    <h3 class="font-bold text-lg">Logout</h3>
    <p class="py-3 text-neutral/60">Are you sure you want to logout?</p>
    <div class="modal-action gap-3">
      <button onclick="document.getElementById('logout-modal').close()" class="btn rounded-2xl flex-1">Cancel</button>
      <button onclick="doLogout()" class="btn btn-error rounded-2xl flex-1 text-white">Logout</button>
    </div>
  </div>
</dialog>

<script>
(function(){
  var t=localStorage.getItem("payoo_theme")||"light";
  document.documentElement.setAttribute("data-theme",t);
  var icon=document.getElementById("theme-icon");
  var tog=document.getElementById("dark-toggle-settings");
  if(t==="dark"){if(icon)icon.className="fa-solid fa-sun text-base";if(tog)tog.checked=true;}
})();
function toggleTheme(){
  var c=document.documentElement.getAttribute("data-theme");
  var n=c==="dark"?"light":"dark";
  document.documentElement.setAttribute("data-theme",n);
  localStorage.setItem("payoo_theme",n);
  var icon=document.getElementById("theme-icon");
  var tog=document.getElementById("dark-toggle-settings");
  if(n==="dark"){icon.className="fa-solid fa-sun text-base";if(tog)tog.checked=true;}
  else{icon.className="fa-solid fa-moon text-base";if(tog)tog.checked=false;}
}
function confirmLogout(){document.getElementById("logout-modal").showModal();}
      // expose new nav sections globally so machine.js ALL_SECTIONS picks them up
      window.EXTRA_SECTIONS=["split","savings","budget","loans","referral","achievements","recharge","emi","spin","notes","transport","finance","ai"];
function doLogout(){localStorage.removeItem("payoo_logged_in");window.location.assign("./index.html");}
function clearTransactionHistory(){
  if(confirm("Clear all transaction history?")){
    localStorage.removeItem("payoo_transactions");
    renderTransactionHistory();updateBadge();
  }
}
</script>

<script src="./script/machine.js"></script>
<script src="./script/addmoney.js"></script>
<script src="./script/sendmoney.js"></script>
<script src="./script/paybill.js"></script>
<script src="./script/getbonus.js"></script>
<script src="./script/cashout.js"></script>
 <script src="./script/finance.js"></script>
 <script src="./script/transport.js"></script>
 <script src="./script/utilities.js"></script>
 <script src="./script/recharge.js"></script>
 <script src="./script/newfeatures.js"></script>
 <script src="./script/features.js"></script>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     AI ADVISOR â€” Simulated AI (works fully offline)
     6 features: Chat Â· Anomaly Â· Prediction Â· Tag Â· Bills Â· Reminders
     All logic runs locally on real localStorage transaction data.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<!-- AI SECTION HTML (injected into main by nav patch below) -->
<template id="ai-section-tpl">
<section id="sec-ai" class="hidden w-11/12 mx-auto py-5 animate-fade-in">

  <!-- Header -->
  <div class="flex items-center gap-3 mb-5">
    <div class="w-12 h-12 rounded-2xl flex items-center justify-center text-white" style="background:linear-gradient(135deg,#7c3aed,#3B25C1)">
      <i class="fa-solid fa-robot text-xl"></i>
    </div>
    <div>
      <h2 class="font-black text-2xl leading-tight">AI Advisor</h2>
      <p class="text-xs text-gray-400 mt-0.5">Smart insights from your real transaction data</p>
    </div>
  </div>

  <!-- Tabs -->
  <div class="flex gap-2 overflow-x-auto pb-2 mb-4" style="scrollbar-width:none;">
    <button onclick="setAiTab('chat')"    id="aitab-chat"    class="aitab btn btn-sm rounded-xl border-none shrink-0 text-xs bg-violet-600 text-white">ğŸ’¬ Chat</button>
    <button onclick="setAiTab('anomaly')" id="aitab-anomaly" class="aitab btn btn-sm rounded-xl border-none shrink-0 text-xs bg-base-200">ğŸš¨ Unusual</button>
    <button onclick="setAiTab('predict')" id="aitab-predict" class="aitab btn btn-sm rounded-xl border-none shrink-0 text-xs bg-base-200">ğŸ“‰ Predict</button>
    <button onclick="setAiTab('tag')"     id="aitab-tag"     class="aitab btn btn-sm rounded-xl border-none shrink-0 text-xs bg-base-200">ğŸ·ï¸ Auto-Tag</button>
    <button onclick="setAiTab('bills')"   id="aitab-bills"   class="aitab btn btn-sm rounded-xl border-none shrink-0 text-xs bg-base-200">ğŸ“… Bills</button>
    <button onclick="setAiTab('remind')"  id="aitab-remind"  class="aitab btn btn-sm rounded-xl border-none shrink-0 text-xs bg-base-200">â° Reminders</button>
  </div>

  <!-- â”€â”€ 1. CHAT â”€â”€ -->
  <div id="aip-chat">
    <div class="card bg-base-100 rounded-3xl overflow-hidden mb-3 border border-base-200">
      <div id="ai-chat-box" class="p-4 space-y-3 overflow-y-auto" style="min-height:260px;max-height:380px;">
        <div class="flex gap-2 items-start">
          <div class="w-7 h-7 rounded-full bg-violet-600 flex items-center justify-center shrink-0 mt-0.5 text-white text-xs"><i class="fa-solid fa-robot"></i></div>
          <div class="bg-base-200 rounded-2xl rounded-tl-sm px-4 py-3 max-w-xs text-sm leading-relaxed">Hi! I'm your Payoo AI Advisor ğŸ¤–<br>Ask me anything about your spending!</div>
        </div>
      </div>
      <div class="px-4 pb-3 border-t border-base-200 pt-3">
        <p class="text-xs text-gray-400 font-semibold mb-2">Quick questions:</p>
        <div class="flex flex-wrap gap-1.5">
          <button onclick="aiQ('How much did I spend this month?')" class="btn btn-xs rounded-xl bg-violet-50 text-violet-700 border-none text-xs">This month</button>
          <button onclick="aiQ('What is my biggest expense?')" class="btn btn-xs rounded-xl bg-violet-50 text-violet-700 border-none text-xs">Biggest expense</button>
          <button onclick="aiQ('How many transactions do I have?')" class="btn btn-xs rounded-xl bg-violet-50 text-violet-700 border-none text-xs">Total transactions</button>
          <button onclick="aiQ('Am I spending too much?')" class="btn btn-xs rounded-xl bg-violet-50 text-violet-700 border-none text-xs">Am I overspending?</button>
          <button onclick="aiQ('What is my current balance?')" class="btn btn-xs rounded-xl bg-violet-50 text-violet-700 border-none text-xs">My balance</button>
          <button onclick="aiQ('Show my last 5 transactions')" class="btn btn-xs rounded-xl bg-violet-50 text-violet-700 border-none text-xs">Recent 5</button>
        </div>
      </div>
      <div class="flex gap-2 p-3 border-t border-base-200">
        <input id="ai-chat-inp" type="text" placeholder="Ask about your financesâ€¦"
          class="input input-bordered rounded-2xl flex-1 h-10 text-sm"
          onkeydown="if(event.key==='Enter')aiSend()"/>
        <button onclick="aiSend()" class="btn bg-violet-600 text-white border-none rounded-2xl h-10 w-10 p-0 shrink-0">
          <i class="fa-solid fa-paper-plane text-sm"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- â”€â”€ 2. UNUSUAL SPEND â”€â”€ -->
  <div id="aip-anomaly" class="hidden">
    <div class="card bg-base-100 rounded-3xl p-4 mb-3">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-10 h-10 rounded-2xl bg-red-100 text-red-500 flex items-center justify-center text-lg shrink-0"><i class="fa-solid fa-triangle-exclamation"></i></div>
        <div><p class="font-bold">Unusual Spend Detector</p><p class="text-xs text-gray-400">Flags transactions outside your normal pattern</p></div>
      </div>
      <button onclick="runAnomaly()" class="btn bg-red-500 text-white border-none rounded-2xl w-full h-11 font-semibold">
        <i class="fa-solid fa-magnifying-glass mr-2"></i>Analyse My Transactions
      </button>
    </div>
    <div id="ai-anomaly-out"></div>
  </div>

  <!-- â”€â”€ 3. PREDICTION â”€â”€ -->
  <div id="aip-predict" class="hidden">
    <div class="card bg-base-100 rounded-3xl p-4 mb-3">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-10 h-10 rounded-2xl bg-orange-100 text-orange-500 flex items-center justify-center text-lg shrink-0"><i class="fa-solid fa-chart-line"></i></div>
        <div><p class="font-bold">Expense Prediction</p><p class="text-xs text-gray-400">Will you run out of money this month?</p></div>
      </div>
      <button onclick="runPredict()" class="btn bg-orange-500 text-white border-none rounded-2xl w-full h-11 font-semibold">
        <i class="fa-solid fa-calendar-day mr-2"></i>Predict My Month
      </button>
    </div>
    <div id="ai-predict-out"></div>
  </div>

  <!-- â”€â”€ 4. AUTO TAG â”€â”€ -->
  <div id="aip-tag" class="hidden">
    <div class="card bg-base-100 rounded-3xl p-4 mb-3">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-10 h-10 rounded-2xl bg-blue-100 text-blue-500 flex items-center justify-center text-lg shrink-0"><i class="fa-solid fa-tags"></i></div>
        <div><p class="font-bold">Auto Category Tagging</p><p class="text-xs text-gray-400">Labels every transaction by spending type</p></div>
      </div>
      <button onclick="runTag()" class="btn bg-blue-500 text-white border-none rounded-2xl w-full h-11 font-semibold">
        <i class="fa-solid fa-wand-magic-sparkles mr-2"></i>Tag My Transactions
      </button>
    </div>
    <div id="ai-tag-out"></div>
  </div>

  <!-- â”€â”€ 5. BILL PREDICTION â”€â”€ -->
  <div id="aip-bills" class="hidden">
    <div class="card bg-base-100 rounded-3xl p-4 mb-3">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-10 h-10 rounded-2xl bg-green-100 text-green-600 flex items-center justify-center text-lg shrink-0"><i class="fa-solid fa-calendar-check"></i></div>
        <div><p class="font-bold">Bill Due Prediction</p><p class="text-xs text-gray-400">Predicts when your recurring bills are due</p></div>
      </div>
      <button onclick="runBills()" class="btn bg-green-600 text-white border-none rounded-2xl w-full h-11 font-semibold">
        <i class="fa-solid fa-calendar-days mr-2"></i>Predict My Bills
      </button>
    </div>
    <div id="ai-bills-out"></div>
  </div>

  <!-- â”€â”€ 6. SMART REMINDERS â”€â”€ -->
  <div id="aip-remind" class="hidden">
    <div class="card bg-base-100 rounded-3xl p-4 mb-3">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-10 h-10 rounded-2xl bg-amber-100 text-amber-500 flex items-center justify-center text-lg shrink-0"><i class="fa-solid fa-bell"></i></div>
        <div><p class="font-bold">Smart Reminders</p><p class="text-xs text-gray-400">Personalised financial reminders based on your data</p></div>
      </div>
      <button onclick="runRemind()" class="btn bg-amber-500 text-white border-none rounded-2xl w-full h-11 font-semibold">
        <i class="fa-solid fa-lightbulb mr-2"></i>Generate My Reminders
      </button>
    </div>
    <div id="ai-remind-out"></div>
  </div>

</section>
</template>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AI ADVISOR â€” SIMULATED ENGINE
// Reads real Payoo localStorage data, analyses locally,
// returns smart human-written responses. 100% offline.
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â”€â”€ Inject section HTML into main on first nav â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function(){
  var _orig = window.setNav;
  if(!_orig) { setTimeout(arguments.callee, 300); return; }
  window.setNav = function(id) {
    // Ensure sec-ai exists in DOM
    if(!document.getElementById('sec-ai')) {
      var tpl = document.getElementById('ai-section-tpl');
      if(tpl) document.getElementById('main-content').insertAdjacentHTML('beforeend', tpl.innerHTML);
    }
    _orig(id);
    if(id === 'ai') { setAiTab('chat'); }
  };
})();

// â”€â”€ Data helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var AI_CREDIT = ["Money Added","Bonus Credited","Lucky Spin Bonus","Referral Bonus"];

function aiTxs() {
  try { return JSON.parse(localStorage.getItem('payoo_transactions')||'[]'); } catch(e){return [];}
}
function aiBal()  { return Number(localStorage.getItem('payoo_balance')||0); }
function aiName() { return localStorage.getItem('payoo_profile_name')||'User'; }

function aiCtx() {
  var txs = aiTxs(), bal = aiBal(), name = aiName();
  var now = new Date(), ms = new Date(now.getFullYear(), now.getMonth(), 1);
  var day = now.getDate(), dim = new Date(now.getFullYear(), now.getMonth()+1, 0).getDate();
  var spend = 0, income = 0;
  txs.forEach(function(t){
    if(!t.success||!t.amount) return;
    var d = new Date(t.date); if(d < ms) return;
    if(AI_CREDIT.indexOf(t.title) !== -1) income += Number(t.amount);
    else spend += Number(t.amount);
  });
  var dailyAvg = day > 0 ? spend/day : 0;
  var projectedSpend = dailyAvg * dim;
  var projectedBal = bal - (projectedSpend - spend);
  return { txs:txs, bal:bal, name:name, spend:spend, income:income,
           day:day, dim:dim, dailyAvg:dailyAvg, projectedSpend:projectedSpend,
           projectedBal:projectedBal, total:txs.length };
}

function fmtN(n){ return Math.round(n).toLocaleString(); }
function esc(t){ return String(t||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

// â”€â”€ Tab switcher â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var AI_PANELS = ['chat','anomaly','predict','tag','bills','remind'];
function setAiTab(id) {
  AI_PANELS.forEach(function(p){
    var panel = document.getElementById('aip-'+p);
    var btn   = document.getElementById('aitab-'+p);
    if(panel) panel.classList.toggle('hidden', p !== id);
    if(btn){
      btn.classList.toggle('bg-violet-600', p === id);
      btn.classList.toggle('text-white',    p === id);
      btn.classList.toggle('bg-base-200',   p !== id);
    }
  });
}

// â”€â”€ Result card builder â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function aiCard(icon, title, body, cls) {
  cls = cls || 'bg-base-100 border-base-200';
  return '<div class="card border rounded-2xl p-4 mb-3 '+cls+'">'+
    '<div class="flex gap-3 items-start">'+
      '<span class="text-2xl shrink-0">'+icon+'</span>'+
      '<div><p class="font-bold text-sm mb-1">'+esc(title)+'</p>'+
      '<p class="text-sm leading-relaxed text-gray-600">'+body+'</p></div>'+
    '</div></div>';
}

function aiBadge(label, cls) {
  return '<span class="text-xs font-bold px-2 py-0.5 rounded-full '+cls+'">'+label+'</span>';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FEATURE 1 â€” CHAT ASSISTANT (simulated NLP)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function aiQ(q){ document.getElementById('ai-chat-inp').value=q; aiSend(); }

function aiSend() {
  var inp = document.getElementById('ai-chat-inp');
  var msg = (inp.value||'').trim();
  if(!msg) return;
  inp.value = '';
  aiAddBubble('user', msg);

  // Simulate brief thinking delay
  setTimeout(function(){
    var reply = aiReply(msg.toLowerCase());
    aiAddBubble('ai', reply);
  }, 400);
}

function aiAddBubble(role, text) {
  var box = document.getElementById('ai-chat-box');
  if(!box) return;
  var isUser = role === 'user';
  var div = document.createElement('div');
  div.className = 'flex gap-2 items-start' + (isUser ? ' flex-row-reverse' : '');
  div.innerHTML = (isUser ? '' :
    '<div class="w-7 h-7 rounded-full bg-violet-600 flex items-center justify-center shrink-0 mt-0.5 text-white text-xs"><i class="fa-solid fa-robot"></i></div>') +
    '<div class="px-4 py-3 rounded-2xl text-sm leading-relaxed max-w-xs ' +
    (isUser ? 'bg-violet-600 text-white rounded-tr-sm' : 'bg-base-200 text-gray-800 rounded-tl-sm') +
    '">' + esc(text) + '</div>';
  box.appendChild(div);
  box.scrollTop = box.scrollHeight;
}

function aiReply(q) {
  var ctx = aiCtx();
  if(!ctx.total) return "I don't see any transactions yet! Make some transactions in Payoo first, then come back and ask me anything.";

  var txs = ctx.txs;
  var debits = txs.filter(function(t){ return t.success && t.amount && AI_CREDIT.indexOf(t.title)===-1; });

  // Balance / general
  if(/balance|how much.*have|wallet/.test(q))
    return "Your current Payoo balance is à§³"+fmtN(ctx.bal)+". You've spent à§³"+fmtN(ctx.spend)+" so far this month.";

  // Monthly spend
  if(/this month|monthly spend|spend.*month|month.*spend/.test(q))
    return "This month (day "+ctx.day+" of "+ctx.dim+") you've spent à§³"+fmtN(ctx.spend)+" and received à§³"+fmtN(ctx.income)+". Your daily average is à§³"+fmtN(ctx.dailyAvg)+".";

  // Biggest expense
  if(/biggest|largest|most.*spend|highest/.test(q)) {
    var top = debits.slice().sort(function(a,b){return Number(b.amount)-Number(a.amount);})[0];
    if(!top) return "I couldn't find any debit transactions yet.";
    return "Your biggest single expense is à§³"+fmtN(top.amount)+" for "+top.title+(top.subtitle?" ("+top.subtitle+")":"")+". That's quite a significant transaction!";
  }

  // Transaction count
  if(/how many|total.*trans|count/.test(q))
    return "You have "+ctx.total+" transactions recorded in total. "+debits.length+" are debits and "+(ctx.total-debits.length)+" are credits.";

  // Overspending
  if(/too much|overspend|over budget|afford/.test(q)) {
    var pct = ctx.dim > 0 ? (ctx.day/ctx.dim)*100 : 0;
    var spendPct = ctx.projectedSpend > 0 ? (ctx.spend/ctx.projectedSpend)*100 : 0;
    if(ctx.projectedBal < 0)
      return "âš ï¸ Based on your current rate, you're projected to overspend by à§³"+fmtN(Math.abs(ctx.projectedBal))+" this month. You may want to reduce spending for the remaining "+(ctx.dim-ctx.day)+" days.";
    if(spendPct > 60)
      return "You've used "+Math.round(spendPct)+"% of your projected monthly budget already. Keep an eye on spending â€” you have "+(ctx.dim-ctx.day)+" days left this month.";
    return "Your spending looks reasonable so far! You've spent à§³"+fmtN(ctx.spend)+" out of a projected à§³"+fmtN(ctx.projectedSpend)+" for this month.";
  }

  // Run out of money
  if(/run out|enough|last.*month|survive|afford/.test(q)) {
    if(ctx.projectedBal < 0)
      return "ğŸš¨ At your current spending rate of à§³"+fmtN(ctx.dailyAvg)+"/day, you may run out of money before month-end. Your projected balance is à§³"+fmtN(ctx.projectedBal)+".";
    return "You should be okay! Your projected month-end balance is à§³"+fmtN(ctx.projectedBal)+". You're spending about à§³"+fmtN(ctx.dailyAvg)+" per day.";
  }

  // Saving tips
  if(/save|saving|tip|advice|suggest/.test(q)) {
    var tips = [
      "Try the 50-30-20 rule: 50% needs, 30% wants, 20% savings. Based on your income, aim to save à§³"+fmtN(ctx.income*0.2)+" this month.",
      "Your daily average spend is à§³"+fmtN(ctx.dailyAvg)+". Cutting just à§³100/day would save à§³"+fmtN(100*(ctx.dim-ctx.day))+" by month-end!",
      "Set up a savings goal in the Savings section. Even à§³500/week adds up to à§³26,000 a year!",
      "Review your bill payments â€” look for subscriptions you no longer use. Small recurring costs add up fast."
    ];
    return tips[Math.floor(Math.random()*tips.length)];
  }

  // Last N transactions
  if(/last|recent|show.*trans/.test(q)) {
    var n = 5; var m = q.match(/\d+/); if(m) n = Math.min(parseInt(m[0]),10);
    var recent = txs.slice(0,n);
    if(!recent.length) return "No transactions found yet!";
    var lines = recent.map(function(t,i){
      return (i+1)+". "+t.title+(t.amount?" à§³"+fmtN(t.amount):"")+(t.date?" Â· "+t.date.substring(0,10):"");
    }).join("\n");
    return "Here are your last "+recent.length+" transactions:\n"+lines;
  }

  // Send money
  if(/send|transfer|paid/.test(q)) {
    var sends = debits.filter(function(t){return /send|transfer/i.test(t.title);});
    if(!sends.length) return "I don't see any Send Money transactions yet.";
    var total = sends.reduce(function(s,t){return s+Number(t.amount);},0);
    return "You've made "+sends.length+" money transfers totalling à§³"+fmtN(total)+". Your most recent was "+sends[0].title+(sends[0].date?" on "+sends[0].date.substring(0,10):"")+".";
  }

  // Bills
  if(/bill|utility|electric|water|gas|internet/.test(q)) {
    var bills = debits.filter(function(t){return /bill|wasa|desco|titas|internet|btcl|utility/i.test(t.title+t.subtitle);});
    if(!bills.length) return "I don't see any utility bill payments in your history yet.";
    var btotal = bills.reduce(function(s,t){return s+Number(t.amount);},0);
    return "I found "+bills.length+" bill payment(s) totalling à§³"+fmtN(btotal)+". Your most recent was à§³"+fmtN(bills[0].amount)+" for "+bills[0].title+".";
  }

  // Default
  var greets = ["That's a great question!", "Let me check your data!", "Good thinking!"];
  return greets[Math.floor(Math.random()*greets.length)]+" Based on your "+ctx.total+" transactions, your balance is à§³"+fmtN(ctx.bal)+" and you've spent à§³"+fmtN(ctx.spend)+" this month. Ask me something more specific!";
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FEATURE 2 â€” UNUSUAL SPEND DETECTION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function runAnomaly() {
  var out = document.getElementById('ai-anomaly-out');
  if(!out) return;
  var ctx = aiCtx();
  if(!ctx.total) { out.innerHTML = aiCard('ğŸ“­','No Data','Make some transactions first!','bg-base-100 border-base-200'); return; }

  var debits = ctx.txs.filter(function(t){ return t.success && t.amount && AI_CREDIT.indexOf(t.title)===-1; });
  if(debits.length < 2) { out.innerHTML = aiCard('ğŸ“­','Not Enough Data','Need at least 2 transactions to detect patterns.','bg-base-100 border-base-200'); return; }

  var amounts = debits.map(function(t){return Number(t.amount);});
  var avg = amounts.reduce(function(a,b){return a+b;},0)/amounts.length;
  var variance = amounts.reduce(function(s,a){return s+Math.pow(a-avg,2);},0)/amounts.length;
  var stdDev = Math.sqrt(variance);
  var threshold = avg + 2*stdDev;

  var flags = [];

  // Flag large amounts
  debits.forEach(function(t){
    var amt = Number(t.amount);
    if(amt > threshold && threshold > 0) {
      flags.push({ emoji:'ğŸ’¸', title:'Unusually Large Transaction', body:'à§³'+fmtN(amt)+' for '+t.title+(t.subtitle?' ('+t.subtitle+')':'')+' is '+Math.round(amt/avg)+'Ã— your average spend of à§³'+fmtN(avg)+'.', severity:'high' });
    }
  });

  // Detect duplicate amounts on same day
  var byDay = {};
  debits.forEach(function(t){
    var key = (t.date||'').substring(0,10)+'_'+t.amount;
    if(!byDay[key]) byDay[key]=[];
    byDay[key].push(t);
  });
  Object.keys(byDay).forEach(function(k){
    if(byDay[k].length > 1) {
      var t = byDay[k][0];
      flags.push({ emoji:'ğŸ”', title:'Duplicate Amount on Same Day', body:byDay[k].length+' transactions of à§³'+fmtN(t.amount)+' on '+(t.date||'').substring(0,10)+'. Could be a duplicate payment.', severity:'medium' });
    }
  });

  // Failed transactions
  var failed = ctx.txs.filter(function(t){return !t.success && t.amount;});
  if(failed.length >= 2) {
    flags.push({ emoji:'âŒ', title:'Multiple Failed Transactions', body:failed.length+' failed transactions detected. This might indicate PIN issues or insufficient balance attempts.', severity:'medium' });
  }

  // Night-time transactions (if date has time)
  var nightTx = debits.filter(function(t){
    var d = new Date(t.date); return !isNaN(d) && (d.getHours() < 5 || d.getHours() > 23);
  });
  if(nightTx.length) {
    flags.push({ emoji:'ğŸŒ™', title:'Late-Night Transaction', body:nightTx.length+' transaction(s) between midnight and 5am. Just making sure it was you!', severity:'low' });
  }

  var html = '';
  if(!flags.length) {
    html = aiCard('âœ…','All Clear!','No unusual spending patterns detected. Your transactions look perfectly normal!','bg-green-50 border-green-200');
  } else {
    var sev = {'high':'bg-red-50 border-red-200','medium':'bg-orange-50 border-orange-200','low':'bg-yellow-50 border-yellow-200'};
    var badge = {'high':aiBadge('HIGH','bg-red-100 text-red-700'),'medium':aiBadge('MEDIUM','bg-orange-100 text-orange-700'),'low':aiBadge('LOW','bg-yellow-100 text-yellow-700')};
    flags.forEach(function(f){
      html += '<div class="card border rounded-2xl p-4 mb-3 '+sev[f.severity]+'">'+
        '<div class="flex gap-3 items-start">'+
        '<span class="text-2xl shrink-0">'+f.emoji+'</span>'+
        '<div><div class="flex items-center gap-2 mb-1"><p class="font-bold text-sm">'+esc(f.title)+'</p>'+badge[f.severity]+'</div>'+
        '<p class="text-sm leading-relaxed text-gray-600">'+esc(f.body)+'</p></div>'+
        '</div></div>';
    });
  }
  out.innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FEATURE 3 â€” EXPENSE PREDICTION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function runPredict() {
  var out = document.getElementById('ai-predict-out');
  if(!out) return;
  var ctx = aiCtx();
  if(!ctx.total) { out.innerHTML = aiCard('ğŸ“­','No Data','Make some transactions first!','bg-base-100 border-base-200'); return; }

  var daysLeft = ctx.dim - ctx.day;
  var projectedTotal = ctx.dailyAvg * ctx.dim;
  var projectedEnd   = ctx.bal - (ctx.dailyAvg * daysLeft);
  var verdict = projectedEnd < 0 ? 'danger' : projectedEnd < ctx.bal*0.15 ? 'warning' : 'safe';

  var vMap = {
    safe:    { emoji:'âœ…', label:'You\'re On Track', color:'text-green-600', bg:'bg-green-50 border-green-300' },
    warning: { emoji:'âš ï¸', label:'Watch Your Spending', color:'text-orange-600', bg:'bg-orange-50 border-orange-300' },
    danger:  { emoji:'ğŸš¨', label:'Running Low!', color:'text-red-600', bg:'bg-red-50 border-red-300' }
  };
  var v = vMap[verdict];

  var tip = verdict==='danger'
    ? 'Try to limit spending to à§³'+fmtN(ctx.bal/Math.max(daysLeft,1))+' per day to avoid running out.'
    : verdict==='warning'
    ? 'You have à§³'+fmtN(projectedEnd)+' projected at month-end. Consider pausing non-essential spending.'
    : 'Great job! Keep your daily spend under à§³'+fmtN(ctx.dailyAvg*1.1)+' to stay comfortable.';

  var html = '<div class="card border-2 rounded-3xl p-5 mb-3 '+v.bg+'">'+
    '<div class="text-center mb-4">'+
      '<div class="text-4xl mb-2">'+v.emoji+'</div>'+
      '<p class="font-black text-xl '+v.color+'">'+v.label+'</p>'+
      '<p class="text-xs text-gray-400 mt-1">Month-end prediction Â· Day '+ctx.day+' of '+ctx.dim+'</p>'+
    '</div>'+
    '<div class="grid grid-cols-3 gap-2 mb-4">'+
      '<div class="bg-white/70 rounded-2xl p-3 text-center"><p class="text-xs text-gray-400">Daily Avg</p><p class="font-black text-sm">à§³'+fmtN(ctx.dailyAvg)+'</p></div>'+
      '<div class="bg-white/70 rounded-2xl p-3 text-center"><p class="text-xs text-gray-400">Days Left</p><p class="font-black text-sm">'+daysLeft+'</p></div>'+
      '<div class="bg-white/70 rounded-2xl p-3 text-center"><p class="text-xs text-gray-400">Est. End Bal</p><p class="font-black text-sm">à§³'+fmtN(projectedEnd)+'</p></div>'+
    '</div>'+
    '<p class="text-sm text-gray-600 leading-relaxed mb-3">'+
      'At à§³'+fmtN(ctx.dailyAvg)+'/day you\'ll spend about à§³'+fmtN(projectedTotal)+' this month. '+
      (projectedEnd >= 0 ? 'Projected end balance: à§³'+fmtN(projectedEnd)+'.' : 'You\'re projected to go à§³'+fmtN(Math.abs(projectedEnd))+' into deficit!')+
    '</p>'+
    '<div class="bg-white/70 rounded-2xl p-3">'+
      '<p class="text-xs font-bold text-gray-400 mb-1">ğŸ’¡ AI TIP</p>'+
      '<p class="text-sm text-gray-700">'+esc(tip)+'</p>'+
    '</div>'+
  '</div>';
  out.innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FEATURE 4 â€” AUTO CATEGORY TAGGING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
var AI_CATS = [
  { name:'ğŸ” Food & Dining',     keys:['food','restaurant','kfc','pizza','burger','biryani','cafe','tea','lunch','dinner','meal'] },
  { name:'ğŸšŒ Transport',         keys:['pathao','uber','shohoz','rickshaw','cng','bus','fuel','toll','parking','indrive','transport','travel'] },
  { name:'ğŸ’¡ Utilities & Bills', keys:['wasa','desco','dpdc','titas','electricity','gas','water','bill','municipal','btcl','internet','cable'] },
  { name:'ğŸ“± Mobile & Recharge', keys:['recharge','grameenphone','robi','banglalink','teletalk','airtel','mobile','top-up'] },
  { name:'ğŸ›ï¸ Shopping',          keys:['shop','daraz','chaldal','bazar','market','cloth','buy','purchase','store'] },
  { name:'ğŸ’Š Health',            keys:['hospital','clinic','doctor','medicine','pharmacy','health','medical'] },
  { name:'ğŸ¬ Entertainment',     keys:['movie','cinema','netflix','youtube','game','fun','entertainment'] },
  { name:'ğŸ’¸ Money Transfer',    keys:['send money','transfer','payment to','sent to'] },
  { name:'â• Income',            keys:['added','bonus','credited','spin','referral','income'] },
  { name:'ğŸ¦ Savings',          keys:['savings','goal','dps','fdr','deposit'] }
];

function aiCatOf(tx) {
  var hay = ((tx.title||'')+(tx.subtitle||'')).toLowerCase();
  for(var i=0;i<AI_CATS.length;i++){
    var cat = AI_CATS[i];
    for(var j=0;j<cat.keys.length;j++){
      if(hay.indexOf(cat.keys[j])!==-1) return cat.name;
    }
  }
  return 'ğŸ“¦ Other';
}

function runTag() {
  var out = document.getElementById('ai-tag-out');
  if(!out) return;
  var ctx = aiCtx();
  if(!ctx.total) { out.innerHTML = aiCard('ğŸ“­','No Data','Make some transactions first!','bg-base-100 border-base-200'); return; }

  var tagged = ctx.txs.slice(0,30).map(function(t){ return { tx:t, cat:aiCatOf(t) }; });
  var groups = {};
  tagged.forEach(function(item){
    if(!groups[item.cat]) groups[item.cat]=[];
    groups[item.cat].push(item.tx);
  });

  var html = '<div class="card bg-base-100 rounded-3xl p-4 border border-base-200">'+
    '<p class="font-bold text-sm mb-3">ğŸ·ï¸ '+tagged.length+' transactions tagged across '+Object.keys(groups).length+' categories</p>';

  // Pie-like summary bar
  var total = tagged.length;
  html += '<div class="flex gap-1 rounded-full overflow-hidden h-3 mb-4">';
  var colors = ['#7c3aed','#3b82f6','#f97316','#22c55e','#f59e0b','#ec4899','#14b8a6','#ef4444','#8b5cf6','#6b7280'];
  Object.keys(groups).forEach(function(cat, i){
    var pct = (groups[cat].length/total*100).toFixed(1);
    html += '<div style="width:'+pct+'%;background:'+colors[i%colors.length]+'" title="'+cat+'"></div>';
  });
  html += '</div>';

  Object.keys(groups).forEach(function(cat, i){
    var txList = groups[cat];
    var catTotal = txList.filter(function(t){return t.amount;}).reduce(function(s,t){return s+Number(t.amount);},0);
    html += '<div class="bg-base-200 rounded-2xl p-3 mb-2">'+
      '<div class="flex justify-between items-center mb-2">'+
        '<p class="font-bold text-xs text-gray-500 uppercase tracking-wide">'+esc(cat)+'</p>'+
        '<span class="text-xs font-bold text-gray-400">'+txList.length+' tx Â· à§³'+fmtN(catTotal)+'</span>'+
      '</div>'+
      txList.slice(0,5).map(function(t){
        return '<div class="flex justify-between items-center py-1 border-b border-base-300 last:border-0 text-xs">'+
          '<span class="text-gray-700 flex-1 mr-2 truncate">'+esc(t.title)+(t.subtitle?' Â· '+esc(t.subtitle):'')+'</span>'+
          (t.amount?'<span class="font-semibold text-gray-500 shrink-0">à§³'+fmtN(t.amount)+'</span>':'')+
        '</div>';
      }).join('')+
      (txList.length>5?'<p class="text-xs text-gray-400 mt-1 text-center">+' + (txList.length-5) + ' more</p>':'')+
    '</div>';
  });
  html += '</div>';
  out.innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FEATURE 5 â€” BILL DUE PREDICTION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
var BILL_KEYWORDS = [
  { name:'WASA Water',       keys:['wasa','water bill'],    emoji:'ğŸ’§' },
  { name:'Electricity',      keys:['desco','dpdc','electricity','electric bill'], emoji:'âš¡' },
  { name:'Titas Gas',        keys:['titas','gas bill'],     emoji:'ğŸ”¥' },
  { name:'Internet Bill',    keys:['internet','broadband'], emoji:'ğŸ“¡' },
  { name:'Mobile Recharge',  keys:['recharge','top-up'],    emoji:'ğŸ“±' },
  { name:'BTCL Landline',    keys:['btcl','landline'],      emoji:'â˜ï¸' },
  { name:'Cable TV',         keys:['cable','tv bill'],      emoji:'ğŸ“º' },
  { name:'Send Money',       keys:['send money','transfer'],emoji:'ğŸ’¸' }
];

function runBills() {
  var out = document.getElementById('ai-bills-out');
  if(!out) return;
  var ctx = aiCtx();
  if(!ctx.total) { out.innerHTML = aiCard('ğŸ“­','No Data','Make some transactions first!','bg-base-100 border-base-200'); return; }

  var today = ctx.day;
  var found = [];

  BILL_KEYWORDS.forEach(function(bk){
    var matches = ctx.txs.filter(function(t){
      if(!t.success) return false;
      var hay = ((t.title||'')+(t.subtitle||'')).toLowerCase();
      return bk.keys.some(function(k){ return hay.indexOf(k) !== -1; });
    });
    if(!matches.length) return;

    // Find typical payment day from history
    var days = matches.map(function(t){ var d=new Date(t.date); return isNaN(d)?null:d.getDate(); }).filter(Boolean);
    var avgDay = days.length ? Math.round(days.reduce(function(a,b){return a+b;},0)/days.length) : 15;
    var avgAmt = matches.reduce(function(s,t){return s+Number(t.amount||0);},0)/matches.length;
    var daysUntil = avgDay > today ? avgDay - today : (30 - today + avgDay);
    var urgency = daysUntil <= 3 ? 'soon' : daysUntil <= 7 ? 'upcoming' : 'later';

    found.push({ name:bk.name, emoji:bk.emoji, amount:avgAmt, day:avgDay, daysUntil:daysUntil, urgency:urgency, count:matches.length });
  });

  if(!found.length) {
    out.innerHTML = aiCard('ğŸ“­','No Recurring Bills Found','I couldn\'t detect recurring bills yet. The more you use Payoo, the better I can predict your bills!','bg-blue-50 border-blue-200');
    return;
  }

  found.sort(function(a,b){ return a.daysUntil - b.daysUntil; });
  var urgCls = { soon:'bg-red-50 border-red-300', upcoming:'bg-orange-50 border-orange-200', later:'bg-green-50 border-green-200' };
  var urgColor = { soon:'text-red-600', upcoming:'text-orange-600', later:'text-green-600' };

  var html = found.map(function(b){
    return '<div class="card border-2 rounded-2xl p-4 mb-2 '+urgCls[b.urgency]+'">'+
      '<div class="flex justify-between items-center">'+
        '<div class="flex items-center gap-3">'+
          '<span class="text-2xl">'+b.emoji+'</span>'+
          '<div><p class="font-bold text-sm">'+esc(b.name)+'</p>'+
          '<p class="text-xs text-gray-400">Usually around '+b.day+esc(ordinal(b.day))+' each month</p></div>'+
        '</div>'+
        '<div class="text-right">'+
          '<p class="font-black text-sm">à§³'+fmtN(b.amount)+'</p>'+
          '<p class="text-xs font-bold '+urgColor[b.urgency]+'">'+
            (b.daysUntil <= 0 ? 'Due today!' : 'In '+b.daysUntil+' days')+
          '</p>'+
        '</div>'+
      '</div></div>';
  }).join('');
  out.innerHTML = html;
}

function ordinal(n) {
  var s=['th','st','nd','rd'], v=n%100;
  return s[(v-20)%10]||s[v]||s[0];
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FEATURE 6 â€” SMART REMINDERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function runRemind() {
  var out = document.getElementById('ai-remind-out');
  if(!out) return;
  var ctx = aiCtx();

  var reminders = [];

  // Balance reminder
  if(ctx.bal < 1000)
    reminders.push({ emoji:'ğŸš¨', title:'Low Balance Alert', msg:'Your balance is à§³'+fmtN(ctx.bal)+'. Consider adding money to avoid failed transactions.', priority:'high' });
  else if(ctx.bal < 5000)
    reminders.push({ emoji:'âš ï¸', title:'Balance Getting Low', msg:'You have à§³'+fmtN(ctx.bal)+' left. You might want to top up soon.', priority:'medium' });

  // Month-end projection
  var daysLeft = ctx.dim - ctx.day;
  var projEnd = ctx.bal - ctx.dailyAvg * daysLeft;
  if(projEnd < 0)
    reminders.push({ emoji:'ğŸ“‰', title:'Overspend Risk', msg:'At à§³'+fmtN(ctx.dailyAvg)+'/day you may run out by month-end. Try to spend à§³'+fmtN(ctx.bal/Math.max(daysLeft,1))+' or less per day.', priority:'high' });

  // Payday reminder (if early month)
  if(ctx.day <= 5)
    reminders.push({ emoji:'ğŸ’°', title:'New Month, New Budget!', msg:'It\'s the start of the month â€” great time to set a spending limit in Settings and create savings goals.', priority:'medium' });

  // Mid-month check
  if(ctx.day >= 14 && ctx.day <= 16)
    reminders.push({ emoji:'ğŸ“Š', title:'Mid-Month Check-In', msg:'You\'re halfway through the month. You\'ve spent à§³'+fmtN(ctx.spend)+' so far â€” '+Math.round(ctx.spend/(ctx.spend+projEnd)*100)+'% of your projected total.', priority:'medium' });

  // Savings nudge
  if(ctx.income > 0 && ctx.spend < ctx.income*0.8)
    reminders.push({ emoji:'ğŸ¦', title:'Savings Opportunity!', msg:'You\'ve spent less than your income this month! Consider moving à§³'+fmtN(ctx.income*0.15)+' to a savings goal.', priority:'low' });

  // Bill reminder based on ctx day
  if(ctx.day >= 25)
    reminders.push({ emoji:'ğŸ“…', title:'Month-End Bills Due', msg:'Month end is approaching. Make sure your utility bills are paid before the '+ctx.dim+esc(ordinal(ctx.dim))+'.', priority:'medium' });

  // No transactions nudge
  if(!ctx.total)
    reminders.push({ emoji:'ğŸ‘‹', title:'Get Started!', msg:'No transactions yet. Use Payoo to send money, pay bills, or add funds to start tracking your finances.', priority:'low' });

  // Recharge reminder (random nudge)
  reminders.push({ emoji:'ğŸ“±', title:'Mobile Recharge', msg:'Don\'t forget to keep your mobile recharged. You can do it instantly from the Recharge section!', priority:'low' });

  // Always show at least a positive reminder
  if(ctx.total > 10)
    reminders.push({ emoji:'ğŸŒŸ', title:'Great Financial Activity!', msg:'You have '+ctx.total+' transactions recorded. You\'re actively managing your finances â€” keep it up!', priority:'low' });

  // Sort high â†’ low
  var pOrd = {high:0,medium:1,low:2};
  reminders.sort(function(a,b){ return pOrd[a.priority]-pOrd[b.priority]; });
  reminders = reminders.slice(0,6);

  var cls = {high:'bg-red-50 border-red-200', medium:'bg-amber-50 border-amber-200', low:'bg-blue-50 border-blue-200'};
  var pbg = {high:'bg-red-100 text-red-700', medium:'bg-amber-100 text-amber-700', low:'bg-blue-100 text-blue-700'};

  var html = reminders.map(function(r){
    return '<div class="card border-2 rounded-2xl p-4 mb-2 '+cls[r.priority]+'">'+
      '<div class="flex gap-3 items-start">'+
        '<span class="text-2xl shrink-0">'+r.emoji+'</span>'+
        '<div><div class="flex items-center gap-2 mb-1">'+
          '<p class="font-bold text-sm">'+esc(r.title)+'</p>'+
          aiBadge(r.priority.toUpperCase(), pbg[r.priority])+
        '</div><p class="text-sm leading-relaxed text-gray-600">'+esc(r.msg)+'</p></div>'+
      '</div></div>';
  }).join('');

  html += '<button onclick="runRemind()" class="btn bg-amber-500 text-white border-none rounded-2xl w-full h-10 text-sm font-semibold mt-1">'+
    '<i class="fa-solid fa-arrows-rotate mr-2"></i>Refresh Reminders</button>';

  out.innerHTML = html;
}
</script>
</body>
</html>